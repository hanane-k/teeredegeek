(function(win,$){var doc=win.document,_URL_PREFIX="/Recommendations/",_ADD_TO_BASKET_PREFIX="/AddToBasketManager.mvc",prodPrices={};ajaxJson=function(data,successCallBack){$.ajax({url:_URL_PREFIX+data.route,type:'POST',dataType:'json',data:JSON.stringify(data),contentType:'application/json; charset=utf-8',cache:false,async:true,success:successCallBack})};$.init("recommendations",function(opt){var cookie=opt.siteRateCookieId,provA=opt.providerToTestA,provB=opt.providerToTestB,expectedValue=opt.expectedCookieValue||"1",placements=[],valuedCookie=cookie+"."+expectedValue,isVersion=$.cookies.isSiteVersionActive(valuedCookie);$(".jsRecSwCarousel:empty").each(function(){var $t=$(this),provider=$t.attr("data-provider"),template=$t.attr("data-template"),isVertical=($t.attr("data-vertical")=="True")?true:false,titleFormatter=$t.attr("data-titleFormatter");if($.isTouch()){$t.addClass("isTouchCarrou")}if(cookie=="-1"||(!isVersion&&provider==provA)||(isVersion&&provider==provB)||(provider!=provA&&provider!=provB)){placements.push({id:this.id,provider:provider,template:template,titleFormatter:titleFormatter})}});opt.placements=placements;if(typeof opt.siteMapNodeId=='undefined'||opt.siteMapNodeId==0){opt.siteMapNodeId=$('#TechFormSiteMapNodeId').val()}if(placements.length>0){ajaxJson(opt,function(res){if(res){$(res.data).each(function(){var provider=this.provider;$(this.recommendations).each(function(){var id=this.id,$recoCar=$("#"+id),recoId=this.recommendationRef,firedSkus=[],isRWD=!!($.contextPage&&$.contextPage.getTechForm()),templateName=$recoCar.attr("data-template"),template=null;$(res.templates).each(function(){if(this.key==templateName){template=this.value;return false}});if(this.products&&this.products.length){tempMus=Mustache.render(template!=null?template:res.template,this);$recoCar.html(tempMus);$recoSwCar=$(".jsSwCarousel",$recoCar);if($recoSwCar){var loadImmediately=typeof $.fn.raAddToBasket==="function";$recoSwCar.carouselSwipe(null,loadImmediately)}else{$("img",$recoCar).lazyload()}$(".crItem",$recoCar).each(function(){var $item=$(this),productId=$item.attr("data-sku"),event;$item.hover(function(){if(firedSkus.indexOf(productId)===-1){event=setTimeout(function(){var interestData=opt;interestData.route="Interest";interestData.productId=productId;interestData.recommendationId=recoId;interestData.interactedPlacementId=id;interestData.providerId=provider;ajaxJson(interestData);firedSkus.push(productId)},5000)}},function(){event&&clearTimeout(event)})})}})})}$(".jsRecSwCarousel:empty").hide()})}else{$(".jsRecSwCarousel:empty").hide()}});$.addRRProductToBasket=function(productId,isProductPageRedirect,productPageUrl){if(isProductPageRedirect===true&&productPageUrl){document.location.href=productPageUrl}else if(productId){$.ajax({type:"GET",url:_ADD_TO_BASKET_PREFIX+"?pageType="+$("#hdnPageType").attr("value")+"&addMainProduct=true&isRichRelevanceProduct=true&productId="+productId+"&isNotRrMaster=true&isForcedPageType=true",success:function(response){var resJson=typeof response==="object"?response:$.parseJSON(response);if(resJson.GoToUrl){document.location.href=resJson.GoToUrl}else if(productPageUrl){document.location.href=productPageUrl}}})}};($.fn.addToBasket==undefined)&&($.fn.addToBasket=$.addRRProductToBasket);$.getRRPriceInformations=function(productIdList){var response="";if(productIdList&&productIdList.push&&productIdList.length>0){productIdList.sort();response=$.ajax({type:"GET",url:PRICER_PROXY_URL+"?productidlist="+productIdList.join(';'),success:function(res){return res}})}else{console.log("getProductPriceInformations: productIdList="+productIdList)}return(response&&!response.PricerServiceProxyError)?$.parseJson(response):{}};$.init("Assembly",function(opt){var selectedAssemblyId=$('#selectedAssemblyId').val();selectedAssemblyTitle=$('#selectedAssemblyTitle').val();if(selectedAssemblyId&&selectedAssemblyTitle){var selectedAssemblyTitle=$('#selectedAssemblyTitle').val();var selectedAssemblyDescFL=$('#selectedAssemblyDescriptionFL').val();var selectedAssemblyDescSL=$('#selectedAssemblyDescriptionSL').val();$("input[type='checkbox'][id^='ckselectedAssembly_']").prop('id','ckselectedAssembly_'+selectedAssemblyId);initSelectedValues(selectedAssemblyTitle,selectedAssemblyDescFL,selectedAssemblyDescSL);selecthiddenAssemb(selectedAssemblyId)}});win.setselectedAssemblyInfo=function(element,assemblyTitle,descriptionFL,descriptionSL,assemblyListIndex,index){var ischecked=$(element).is(':checked');var assContent=$("#assemblyContent");var selectedAssemblyId=getAssemblyId($(element).attr("id"));if(ischecked){if(selectedAssemblyId!=''){$('#selectedAssemblyId').val(selectedAssemblyId);$("input[type='checkbox'][id^='ckselectedAssembly_']").prop('id','ckselectedAssembly_'+selectedAssemblyId);$('#selectedAssemblyTitle').val(assemblyTitle);$('#selectedAssemblyDescriptionFL').val(descriptionFL);$('#selectedAssemblyDescriptionSL').val(descriptionSL)}initSelectedValues(assemblyTitle,descriptionFL,descriptionSL);$('.jsfpAssembly',assContent).find('input[type=checkbox]:checked').removeAttr('checked');$(element).prop('checked',true);$("input[type='checkbox'][id^='ckselectedAssembly_']").prop('checked',true);selecthiddenAssemb(selectedAssemblyId)}else{$("input[type='checkbox'][id^='ckselectedAssembly_']").prop('checked',false);removeSelectedValues();unselecthiddenAssemb()}};win.setselectedAssembly=function(element){var ischecked=$(element).is(':checked');var assContent=$("#assemblyContent");var selectedAssemblyId='';selectedAssemblyId=getAssemblyId($(element).attr("id"));if(ischecked){$('#selectedAssemblyId').val(selectedAssemblyId);$('#assembly_'+selectedAssemblyId).prop('checked',true);selecthiddenAssemb(selectedAssemblyId)}else{$('.jsfpAssembly',assContent).find('input[type=checkbox]:checked').removeAttr('checked');removeSelectedValues();unselecthiddenAssemb()}};win.getAssemblyId=function(AssemblyIdAttr){var assemblyId='';if(AssemblyIdAttr.indexOf("_")>=0){var assemblyIdTab=AssemblyIdAttr.split("_");if(assemblyIdTab&&assemblyIdTab[1]){assemblyId=assemblyIdTab[1]}}return assemblyId};win.initSelectedValues=function(assemblyTitle,descriptionFL,descriptionSL){$('#selectedAssembly').html(assemblyTitle);$('#descriptionFL').html(descriptionFL);$('#descriptionSL').html(descriptionSL)};win.removeSelectedValues=function(){$('#selectedAssemblyId').val('');$('#selectedAssemblyTitle').val('');$('#selectedAssemblyDescriptionFL').val('');$('#selectedAssemblyDescriptionSL').val('')};win.selecthiddenAssemb=function(selectedAssemblyId){$("input[type='hidden'][id^='hassembly_']").val(false);$('#hassembly_'+selectedAssemblyId).val(true)};win.unselecthiddenAssemb=function(){$("input[type='hidden'][id^='hassembly_']").val(false)}})(window,window.$fwk)