/* Js/cdsrwd/wl/rwd/fwk/extendzoom.js */
(function($){$.fn.zoom=function($zoomWindow){var _isEmbededZoom=false,_$mainImage=this,_$zWindow=$zoomWindow,_$zlens=$(".jsZoomLens",_$mainImage),_$fpImgOpen=$(".fpImgOpen",_$mainImage),_$fpImgClose=$(".fpImgClose",_$mainImage),_$hoverTimer,_$img,_mainImgWidht,_mainImgHeight,_mainImgLeft,_mainImgTop,_windowWidth,_windowHeight,_ratioZoomX,_ratioZoomY,_zLensWidth,_zLensHeight,_isXZommActive,_isYZommActive;_isEmbededZoom=!_$zWindow||!_$zWindow.length;if(_isEmbededZoom){_$zWindow=$("<div>").appendTo(_$mainImage)}var _initZoom=function(){_$img=$(new Image);if(_isEmbededZoom){_$img.css({"max-width":"none",position:"absolute","z-index":"2"})}_$zWindow.append(_$img);$(_$img).load(function(){_mainImgHeight=_$mainImage.height(),_mainImgWidht=_$mainImage.width(),_mainImgLeft=_$mainImage.offset().left,_mainImgTop=_$mainImage.offset().top,_windowWidth=_$zWindow.width(),_windowHeight=_$zWindow.height(),_ratioZoomX=_$img[0].width/_mainImgWidht,_ratioZoomY=_$img[0].height/_mainImgHeight,_zLensWidth=_windowWidth/_ratioZoomX,_zLensHeight=_windowHeight/_ratioZoomY,_isXZommActive=_$img[0].width<_windowWidth,_isYZommActive=_$img[0].height<_windowHeight;_$zWindow.add(_$zlens).fadeIn("fast")})};if(!$.isTouch()){var tag=_$mainImage.data("zoommethod");var _event=tag?"click":"mouseover";if(tag){_$zlens.click(function(event){if(_$img[0].src){_$img[0].src="";_$zWindow.add(_$zlens).hide();_$fpImgOpen.show();_$fpImgClose.hide()}event.stopPropagation()})}var _$zone=tag?_$zlens:_$mainImage;_$zone.mouseout(function(){if(_$hoverTimer){clearTimeout(_$hoverTimer)}if(_$img[0].src){_$hoverTimer=setTimeout(function(){_$img[0].src="";_$zWindow.add(_$zlens).hide();_$fpImgOpen.show();_$fpImgClose.hide()},200)}});_$mainImage.one("mouseenter",_initZoom).on(_event,function(){if(_$hoverTimer){clearTimeout(_$hoverTimer)}_$hoverTimer=setTimeout(function(){_$img[0].src=_$zWindow.data("src");_$fpImgOpen.hide();_$fpImgClose.show()},200)}).mousemove(function(ev){if(_$img[0].src){ev.preventDefault();var x=ev.pageX-_mainImgLeft,y=ev.pageY-_mainImgTop,zWindowX,zWindowY;if(ev.pageX-_zLensWidth/2<_mainImgLeft||_isXZommActive){x=_zLensWidth/2}else if(ev.pageX+_zLensWidth/2>_mainImgLeft+_mainImgWidht){x=_mainImgWidht-_zLensWidth/2+1}if(ev.pageY-_zLensHeight/2<_mainImgTop||_isYZommActive){y=_zLensHeight/2}else if(ev.pageY+_zLensHeight/2>_mainImgTop+_mainImgHeight){y=_mainImgHeight-_zLensHeight/2+1}if(_isEmbededZoom){zWindowX=-(x*(_$img.outerWidth()-_mainImgWidht)/_mainImgWidht);zWindowY=-(y*(_$img.outerHeight()-_mainImgHeight)/_mainImgHeight)}else{zWindowX=Math.ceil(_windowWidth/2-_ratioZoomX*x);zWindowY=Math.ceil(_windowHeight/2-_ratioZoomY*y);_$zlens.outerWidth(_zLensWidth).outerHeight(_zLensHeight);_$zlens.css("left",x-_zLensWidth/2).css("top",y-_zLensHeight/2)}_$img.css("left",zWindowX).css("top",zWindowY)}})}return{setBigImg:function(src){_$zWindow.data("src",src);return this}}}})($fwk);
/* Js/cdsrwd/wl/rwd/page/fp.js */
(function(win,$){!$.fn.lazyload&&($.fn.lazyload=$.noop);!$.fn.countDown&&($.fn.countDown=$.noop);$.init("fp",function(opt){var _doc=win.document,_sku=$.contextPage?$.contextPage.getProductId():"",_$fp=$("#fpContent"),_$fpTop=$(".fpZnTop, .jsTop, .fpTopZn, .fpColFloat",_$fp),_$fpPrdMain=$("#fpZnPrdMain"),_$fpColFloat=$(".jsColFloat",_$fp),_$fpColFloatAdDisplay=$(".jsColFloatAdDisplay",_$fpColFloat),_$fpCommentOnTop=$("#fpCommentOnTop"),_$fpBlocPrice=$("#fpBlocPrice"),_$fpTriplePrice=$(".jsTriplePrice",_$fpColFloat),_$selectSize=$(".jsSltSize",_$fpTop),_$selectCond=$(".jsSltCond",_$fpTop),_$selectColor=$(".jsSltColor",_$fpTop),_$piColor=$(".jsPiColor",_$fpTop),_$sz=$("#sz"),_$bv=$("#fpRating"),_$faq=$("#fpFAQ"),_$faqSocial=$(".fpFAQSocial",_$faq),_$assoProducts=$("#assoProducts"),_$qaBlocProduct=$("#qaBlocProduct"),_$headerZone=$("#header"),_$faqRatingsZone=$("#fpFAQRatings"),_$subscription=$("#fpSubscription"),_$rental=$("#fpRental"),_$fpWlBloc=$("#fpWlBloc"),_$dedicatedDeal=$("#fpDedicatedDeal"),_$fpGarserZone=$("#fpGarserZone"),_$fpAssemblyZone=$("#assemblyContent"),_isSubscriptionAvailable=_$subscription.length>0,_isRentalAvailable=_$rental.length>0,loadSzMsg=function(){},isFired=false,_currency="€",_isFpRedesign=_$fpPrdMain.hasClass('fpRedesign');$ratingBloc=$("#fpRating"),$fpReviewBloc=$(".jsfplightItem",$ratingBloc);var isThreatMetrixTagged=false;var sessionId=undefined;$.init("newAssProduct",function(opt){var $newAssoProduct=$('.jsNewAssMain');var $assoProductSelector=$(".jsAssoProductSelector");var $assoProductPriceBlock=$(".jsAssoBlkPrice")[0];var $assoProductBasketBtns=$(".btGreen",$assoProductPriceBlock);var blkAssoPrice=$(".jsAssPriceBlkPrice",$newAssoProduct)[0];var blkAssoDiscount=$(".jsAssPriceBlkStroken",$newAssoProduct)[0];var blkPriceTitle=$(".jsAssPriceBlkTitle")[0];var blkPriceTextBeforeEco=$(".jsAssTextBlkBeforeEco")[0];var blkPriceTextAfterEco=$(".jsAssTextBlkAfterEco")[0];var blkPriceEcoValue=$(".jsAssPriceBlkEcoValue")[0];var ecoDefaultValue=blkPriceEcoValue.innerText;var nbProductSelect=$(".fpAssoProductChecked",$newAssoProduct).length;var checkbox=undefined;var checkboxText=undefined;$assoProductBasketBtns.each(function(){$mainItemToCheck=$(".jsSltSize, .jsSltColor, .jsSltCond",_$fpTop);$(this).mouseenter(function(event){$(this).parent().checkFormErrors($mainItemToCheck)}).mouseleave(function(event){$(this).parent().ckDisability(false);$(this).removeClass("selMsgVar")});$(this).click(function(){if(!$(this).hasClass('clickDisabled')){$('#fpAddBsk').click()}})});checkEcoNull();function checkEcoNull(){var price=$('.price','.assoMainProduct')[0].innerText,strokenprice=$('.stroken','.assoMainProduct')[0]?$('.stroken','.assoMainProduct')[0].innerText:price;if(price==strokenprice&&!$('.fpAssPriceBlkStrokenText').hasClass('fpAssEcoHidden')){$('.fpAssPriceBlkStrokenText').addClass('fpAssEcoHidden').prev().addClass('fpAssEcoHidden')}};checkPricesLength();function checkPricesLength(){var priceLenght=blkAssoPrice.innerText.length,strokenLenght=blkAssoDiscount.innerText.length;if(priceLenght>6&&strokenLenght>7){$('.fpAssPriceBlkEco').addClass("fpAssMaxCase").prev().addClass("fpAssMaxCase")}else{$('.fpAssPriceBlkEco').removeClass("fpAssMaxCase").prev().removeClass("fpAssMaxCase")}};$assoProductSelector.each(function(){var blkAssoProduct=$(this).parent();var assoProductSizeSelector=$(".jsSltSize",blkAssoProduct);if($(this).parent().find('input[type=checkbox]')[0].checked){checkbox=$(this).parent().find('input[type=checkbox]');checkboxText=$(this).find('.jsAssoProductCheckboxText span');$(this).addClass('clicked');changeCheckBoxText(blkAssoProduct)}$(this).mouseenter(function(event){blkAssoProduct.checkFormErrors(assoProductSizeSelector)}).mouseleave(function(event){blkAssoProduct.ckDisability(false);assoProductSizeSelector.removeClass("selMsgVar")});$(this).click(function(event){checkbox=$(this).parent().find('input[type=checkbox]');checkboxText=$(this).find('.jsAssoProductCheckboxText span');if(!$(this).hasClass("clickDisabled")&&checkbox!=undefined){checkbox[0].checked=!checkbox[0].checked;changeCheckBoxText(blkAssoProduct);checkPricesLength()}})});function changeCheckBoxText(block){if(checkbox!=undefined){if(checkbox.prop('checked')){nbProductSelect++;checkboxText.text(opt.textChecked);block.find(".jsAssoProductSelector").addClass("clicked")}else{nbProductSelect--;checkboxText.text(opt.textCheckedDefault);block.find(".jsAssoProductSelector").removeClass("clicked")}}updateWordingPriceBlk(updatePriceBlk(block))};function updatePriceBlk(block){var priceToAdd=block.find(".price")[0].innerHTML;var priceStrokenToAdd=block.find(".stroken")[0].innerHTML;var boolStrokenPriceZero=blkAssoDiscount.innerHTML=="0,00€";var boolStrokenPriceToAddZero=false;if(!priceStrokenToAdd){if(boolStrokenPriceZero){priceStrokenToAdd="0,00€";boolStrokenPriceToAddZero=true}else{priceStrokenToAdd=priceToAdd.replace(_currency,",").concat(_currency)}}var newPrice=addPrice(blkAssoPrice.innerHTML,priceToAdd).toFixed(2);var newStrokenPrice;if(boolStrokenPriceZero){if(boolStrokenPriceToAddZero){newStrokenPrice=newPrice}else{newStrokenPrice=addPrice(blkAssoPrice.innerHTML.replace(_currency,",").concat(_currency),priceStrokenToAdd).toFixed(2)}}else{newStrokenPrice=addPrice(blkAssoDiscount.innerHTML,priceStrokenToAdd).toFixed(2)}var newEcoPrice=newStrokenPrice=="0.00"?"0.00":(newStrokenPrice-newPrice).toFixed(2);if(newEcoPrice=="0.00"&&!$('.fpAssPriceBlkStrokenText').hasClass('fpAssEcoHidden')){$('.fpAssPriceBlkStrokenText').addClass('fpAssEcoHidden').prev().addClass('fpAssEcoHidden')}if(newEcoPrice!="0.00"&&$('.fpAssPriceBlkStrokenText').hasClass('fpAssEcoHidden')){$('.fpAssPriceBlkStrokenText').removeClass('fpAssEcoHidden').prev().removeClass('fpAssEcoHidden')}blkAssoPrice.innerHTML=renderPriceWithSup(newPrice);blkAssoDiscount.innerText=newStrokenPrice.toString().replace(".",",").concat(_currency);blkPriceEcoValue.innerText=newEcoPrice.toString().replace(".",",").concat(_currency);return newEcoPrice};function addPrice(totalPrice,priceToAdd){if(totalPrice.indexOf(",")>0){totalPrice=deleteLastCaracter(totalPrice);var totalPriceSplit=totalPrice.split(",");priceToAdd=deleteLastCaracter(priceToAdd);var priceToAddSplit=priceToAdd.split(",")}else{var totalPriceSplit=totalPrice.split(_currency);var priceToAddSplit=priceToAdd.split(_currency)}if(checkbox!=undefined&&checkbox.prop('checked')){return parseInt(totalPriceSplit[0])+parseInt(priceToAddSplit[0])+(parseInt(totalPriceSplit[1])/100+parseInt(priceToAddSplit[1])/100)}else{return parseInt(totalPriceSplit[0])-parseInt(priceToAddSplit[0])+(parseInt(totalPriceSplit[1])/100-parseInt(priceToAddSplit[1])/100)}}function renderPriceWithSup(price){var priceSplit=price.toString().split(".");return priceSplit[0].concat("<sup>",_currency,priceSplit[1],"</sup>")}function updateWordingPriceBlk(ecoPrice){if(nbProductSelect==1){blkPriceTitle.innerText=opt.titleTextDefault;blkPriceTextBeforeEco.innerHTML=opt.ecoTextDefault;blkPriceEcoValue.innerText=ecoDefaultValue;if(!opt.noStrikedPrice){blkPriceTextAfterEco.innerText=""}}if(nbProductSelect>1&&!opt.noStrikedPrice){blkPriceTitle.innerText=opt.titleText[0].concat(nbProductSelect,opt.titleText[1]);if(ecoPrice=="0.00"){blkPriceTextBeforeEco.innerHTML=opt.ecoTextDefault.replace("vos","d'autres");blkPriceTextAfterEco.innerText="";blkPriceEcoValue.innerText=ecoDefaultValue}else{blkPriceTextBeforeEco.innerText=opt.ecoText[0];blkPriceTextAfterEco.innerText=opt.ecoText[1]}}}function deleteLastCaracter(element){return element.toString().substring(0,element.length-1)}});var callbackfpPopin=function(){$ratingBlocPopin=$("#ratingBlocPopin");$ratSocial=$(".jsRatSocial",$ratingBlocPopin);$dataReview=$(".jsYesRat",$ratSocial).data("review");$ratSocialParent=$(".jsRatSocial",$ratingBloc);$socialPage=$("[data-review='"+$dataReview+"']",$ratSocialParent).parent(),$yesNoPage=$(".jsYesRat, .jsNoRat",$socialPage),$charsLength=$(".jsFpRatingPublishBy",$ratingBlocPopin).data("min-size");if(!$yesNoPage.is(':visible')&&$yesNoPage.length>0){$(".jsYesRat, .jsNoRat",$ratingBlocPopin).hide();$(".jsRatRelevanceValidated",$ratingBlocPopin).text($(".jsRatRelevanceValidated",$socialPage).text()).fadeIn()}$(function(){$(".jsNext",$ratingBlocPopin).click(function(){next_frame()});$(".jsPrev",$ratingBlocPopin).click(function(){prev_frame()});$(".jsYesRat, .jsNoRat",$ratingBlocPopin).click(function(){var $t=$(this),$p=$t.parent(),$yesNo=$(".jsYesRat, .jsNoRat",$p),$url=$(".jsYesRat",$p).data("review-usefullnessurl");if(!$socialPage.hasClass("disabled")&&!$p.hasClass("disabled")){$.get($url+$t.hasClass("jsYesRat")+"/"+$t.data("review"),function(res){if(res){$yesNo.hide();$(".jsRatRelevanceValidated",$p).text($t.data("review-result")).fadeIn();$yesNoPage.hide();$(".jsRatRelevanceValidated",$socialPage).text($t.data("review-result")).fadeIn()}})}});$btnReportBlock=$(".jsReportReview",$ratingBlocPopin),$link=null;$btnReportBlock.click(function(){var reviewId=$(this).data("review"),urlPopin=$(this).data("url");if(!reviewId||!urlPopin){return false}$link=$(this);var option={addedClass:'popin reportReviewPopin jsReportReviewPopin',callback:callbackReportReview,data:{ReviewId:reviewId}};$.popin.showOverlay();$.popin.loadAjaxPopin(urlPopin,option);return false});function callbackReportReview(){var $reporReviewPopin=$(".jsReportReviewPopinContent",".jsReportReviewPopin"),$reportForm=$("#reportReviewPopinForm"),$txtReport=$(".jsReportReviewText",$reportForm),$buttonReport=$(".jsReportReviewBt",$reportForm),$reportReviewCount=$(".jsReportReviewCharCount",$reportForm),$spanCharCount=$("span",$reportForm),$isCaptchaValidated=$("input[name=IsCaptchaValidated]",$reportForm),reportReviewCaptcha=null;$txtReport.keyup(function(event){var text=$txtReport.val();var charsCount=text.length;if(charsCount>=$charsLength){$reportReviewCount.addClass("hidden");$buttonReport.removeClass("clickDisabled")}else{$spanCharCount.text($charsLength-charsCount);$reportReviewCount.removeClass("hidden");$buttonReport.addClass("clickDisabled")}});$(".jsReportReviewBt",$reportForm).mousemove(function(event){var $t=$(this),reportContent=$txtReport.val(),reportContentLen=reportContent.length;if(!reportContent||reportContentLen<$charsLength){$t.addClass("clickDisabled");$(".jsErrorMsg",$reportForm).show()}});$(".jsReportReviewBt",$reportForm).mouseout(function(event){$(this).removeClass("clickDisabled");$(".jsErrorMsg",$reportForm).hide()});$buttonReport.click(function(event){event.preventDefault();var reportContent=$txtReport.val(),reportContentLen=reportContent.length,$captcha=$(".jsg-recaptcha",$reportForm);refreshCaptcha=function(){if(reportReviewCaptcha==null){reportReviewCaptcha=grecaptcha.render($captcha[0],{sitekey:$captcha.data("sitekey"),"expired-callback":"reportCaptchaExpired"})}else{grecaptcha.reset(reportReviewCaptcha)}};reportCaptchaValidated=function(){setCaptchaValidated(true)};reportCaptchaExpired=function(){setCaptchaValidated(false)};setCaptchaValidated=function(value){if($isCaptchaValidated&&$isCaptchaValidated.length){$isCaptchaValidated.val(value)}};if($isCaptchaValidated.val()!=="true"){refreshCaptcha();return false}if(!reportContent||reportContentLen<$charsLength){$buttonReport.addClass("clickDisabled");$(".jsErrorMsg",$reportForm).show();return false}toggleReport=function(){var $t=$socialPage,$p=$t.parent(),$detRatingP=$t.parents(".jsDetRating"),$star=$detRatingP.find(".jsSta");$(".jsReportReview",$p).remove();$(".jsReported",$p).fadeToggle("fast");$detRatingP.addClass("deactivatedDetRating");$star.addClass("deactivatedRatingStar")};$.ajax({type:"POST",url:this.form.action,dataType:"html",data:$reportForm.serialize(),cache:false,complete:function(){closePopin();toggleReport()}});closePopin=function(){$(".jsCancel",$reporReviewPopin).trigger("click");return false};return false})}$(".jsRatingReport",$ratingBlocPopin).click(function(){var $t=$(this),$p=$t.parent(),$DetRatingP=$t.parents("#ratingBlocPopin"),$star=$DetRatingP.find(".jsSta");var url=$.fn.lnf($t.attr('href'));(new Image).src=url;$t.remove();$(".jsReported",$p).fadeToggle("fast");$DetRatingP.addClass("deactivatedDetRating");$star.addClass("deactivatedRatingStar");return false})});function next_frame(){var cur=$(".jsCurrent",$ratingBlocPopin);var next=$(cur).next();if(next.length==0){next=$(".jsImgContainer:first",$ratingBlocPopin)}$(cur).removeClass("jsCurrent").removeClass("current");$(next).addClass("jsCurrent").addClass("current").show();$(".jsImgContainer").not(".jsCurrent").hide()}function prev_frame(){var cur=$(".jsCurrent",$ratingBlocPopin);var prev=$(cur).prev();if(!($(prev).hasClass("jsImgContainer"))||prev.length==0){prev=$(".jsImgContainer:last",$ratingBlocPopin)}$(cur).removeClass("jsCurrent").removeClass("current");$(prev).addClass("jsCurrent").addClass("current").show();$(".jsImgContainer",$ratingBlocPopin).not(".jsCurrent").hide()}};$fpReviewBloc.on('click','.jsfpreviewImg',function(){var productId=$(this).data("productid");var reviewId=$(this).data("reviewid");var imageClicked=$(this).find(".ImgfpReview").attr("src");var $caroussel=$("#jsSwCarousel");if($caroussel.length){$caroussel.carouselSwipe()}var option={addedClass:'popin container customerReview jsfplightPopin',callback:callbackfpPopin,data:{productId:productId,reviewId:reviewId,imageClicked:imageClicked},isOverflowHidden:false};$.popin.loadAjaxPopin($fpReviewBloc.data("reviewurl"),option)});$fpReviewBloc.on('click','.jsCancel',function(){$(".jsCancel",$fpReviewBloc).trigger("click")});var initPriceWidth=function(){var $fpStrikedPriceAfter=$(".jsFpStrikedAfter",_$fpBlocPrice);var $fpMainPrice=$(".jsMainPrice",_$fpBlocPrice);if($fpStrikedPriceAfter.length){if(($fpMainPrice.width()+$fpStrikedPriceAfter.width())>$(".jsFpPriceBloc",_$fpBlocPrice).width()){$(".jsFpPriceBloc",_$fpBlocPrice).removeClass("fpSmallPrice")}}};initPriceWidth();var initGarser=function(){var $fpFormGarser=$(".jsFpFormGarser",_$fpGarserZone);$fpFormGarser.on("click","li",function(evt){var $checkedElem=$(evt.target);var checkTriggered=!$checkedElem.hasClass("jsfpOverlayContent")&&!$checkedElem.parents(".jsfpOverlayContent").length>0;if(checkTriggered){var $selectedCheckbox=$(this).find('.fpGarserCheckbox input[type=checkbox]');$selectedCheckbox.click();var garserType=$selectedCheckbox.attr('data-garser-group-container-id');$('li',$fpFormGarser).not(this).find('.fpGarserCheckbox input[type=checkbox][data-garser-group-container-id='+garserType+']').prop('checked',false)}})};var initAssembly=function(){var $fpFormAssembly=$(".jsFpFormGarser",_$fpAssemblyZone);$fpFormAssembly.on("click","li",function(evt){var $checkedElem=$(evt.target);var checkTriggered=!$checkedElem.hasClass("jsfpOverlayContent")&&!$checkedElem.parents(".jsfpOverlayContent").length>0;if(checkTriggered){var $selectedCheckbox=$(this).find('.fpGarserCheckbox input[type=checkbox]');$selectedCheckbox.click();var garserType=$selectedCheckbox.attr('data-garser-group-container-id');$('li',$fpFormAssembly).not(this).find('.fpGarserCheckbox input[type=checkbox][data-garser-group-container-id='+garserType+']').prop('checked',false)}});$fpFormAssembly.on("click",".jsAssemblyCkb",function(evt){var selectedAssembly=$("#selectedAssemblyId")[0].value;if(selectedAssembly!=null&&selectedAssembly!=""){$("#fpAssemblyPrice")[0].innerHTML=$("#price_"+selectedAssembly)[0].value+_currency;$("#fpAssemblyTVA")[0].innerHTML=$("#TVA_"+selectedAssembly)[0].value.replace("("," ").replace(")","")}})};function initThreatMetrixTag(){var triggerThreatMetrixTag=function(){var event=document.createEvent("Event");event.initEvent("threatMetrixTagEvent",true,true);window.dispatchEvent(event)};if(window.addEventListener){window.addEventListener("load",triggerThreatMetrixTag,false)}else if(window.attachEvent){window.attachEvent("onload",triggerThreatMetrixTag)}}var initSessionId=function(){var $ocSessionId=$("#ocSessionId");if(!isThreatMetrixTagged){isThreatMetrixTagged=true;$.ajax({url:'/InitSessionId',type:'GET',dataType:"json",success:function(res){sessionId=res;$ocSessionId.val(sessionId);initThreatMetrixTag()},error:function(res){isThreatMetrixTagged=false}})}else if(sessionId&&!$ocSessionId.val()){$ocSessionId.val(sessionId)}};var openOverlay=function($link,$overlayer){if($.isTouch()){var hideOverlayWithTouch=function(){$("#transparentOverlay").hide();$(".fpOverBlk:visible",_$fp).hide();$(".jsfpOverlayContent:visible",_$fp).hide();isFired=false;return false};$link.click(function(){if(!isFired){$(".jsOverlay .fpOverBlk",_$fp).hide();$("#transparentOverlay").show();$overlayer.slideDown(100);isFired=true;return false}}),$(".fpCloseOver",$overlayer).bind("click",hideOverlayWithTouch),$(".fpCloseOverlay",$overlayer).bind("click",hideOverlayWithTouch),$("body").on("click","#transparentOverlay",hideOverlayWithTouch);$(".fpCloseOver",$overlayer).removeClass("dn");$(".fpCloseOverlay",$overlayer).removeClass("dn")}$link.hover(function(){if(!isFired){tShowFac=win.setTimeout(function(){$overlayer.slideDown("fast");isFired=true},150)}},function(){win.clearTimeout(tShowFac);tClosFac=win.setTimeout(function(){$overlayer.hide();isFired=false},150);$overlayer.hover(function(){win.clearTimeout(tClosFac)},function(){$overlayer.hide();isFired=false;win.clearTimeout(tShowFac)})})};var formatPriceForContent=function(price){if(price){price=price.replace(",",".").replace("€","")}return price};var updateUnitPrice=function(newPrice,useReplace){var regEx=/[\d?,|.?\d?]+\s?€/g;var $fpPerUnitPriceSelector=$(".jsPerUnitPrice",_$fpBlocPrice);var existingUnitPriceText=$fpPerUnitPriceSelector&&$fpPerUnitPriceSelector.html();var newPriceLabel=newPrice&&existingUnitPriceText&&useReplace?existingUnitPriceText.replace(regEx,newPrice):newPrice;newPriceLabel&&existingUnitPriceText&&$fpPerUnitPriceSelector.html(newPriceLabel)};var updatePackagedPrice=function(newPrice,useReplace){var regEx=/[\d?,|.?\d?]+\s?€/g;var $fpPackagingUnitPriceSelector=$(".jsPackagingUnitPrice",_$fpBlocPrice);var existingUnitPriceText=$fpPackagingUnitPriceSelector&&$fpPackagingUnitPriceSelector.html();var newPriceLabel=newPrice&&existingUnitPriceText&&useReplace?existingUnitPriceText.replace(regEx,newPrice):newPrice;newPriceLabel&&existingUnitPriceText&&$fpPackagingUnitPriceSelector.html(newPriceLabel)};var updateProductPrice=function($optionSel,$blocPrice){var prices=($optionSel.data("price")||"").split(";"),facilities=($optionSel.data("facility")||"").split(";"),$apartir=$(".jsPriceInfo",$blocPrice),$facPrice=$("#fpFacility .price"),subscriptionPrices=($optionSel.attr("data-subscription-price")||"").split(";"),regularPrices=($optionSel.attr("data-price")||"").split(";"),unitPrice=$optionSel.attr("data-unit-price")||"",packageUnitPrice=$optionSel.attr("data-package-unit-price")||"",subscriptionUnitPrice=$optionSel.attr("data-subscription-unit-price")||"",subscriptionUnitPriceCdav=$optionSel.attr("data-subscription-cdav-unit-price")||"",subscriptionPackageUnitPriceCdav=$optionSel.attr("data-package-subscription-cdav-unit-price")||"",subscriptionPackageUnitPrice=$optionSel.attr("data-package-subscription-unit-price")||"",subscriptionPricesCdav=($optionSel.attr("data-subscription-price-cdav")||"").split(";");if(prices.length>1){var $fpPriceSelector=$(".jsMainPrice",$blocPrice);var $subscriptionUnitPriceSelector=$(".jsPerUnitPrice",$blocPrice);if(_isSubscriptionAvailable&&subscriptionPrices.length>2&&regularPrices.length>4){var subscriptionOption=$(".jsFpSubscriptionRadio:checked",_$subscription);if(subscriptionOption.length>0&&subscriptionOption.val()=="Subscription"){$fpPriceSelector.html(subscriptionPrices[1]);$fpPriceSelector.attr("content",formatPriceForContent(subscriptionPrices[2]));var $cdavSubscriptionSelector=$(".jsAddCdavWithSubscription",_$subscription);if($cdavSubscriptionSelector.length>0&&$cdavSubscriptionSelector.prop('checked')){updateUnitPrice(subscriptionUnitPriceCdav,true);updatePackagedPrice(subscriptionPackageUnitPriceCdav,true);var isClicked=$cdavSubscriptionSelector.is(":checked");if(isClicked){var subscriptionPriceHtml=subscriptionPricesCdav.length>2&&subscriptionPricesCdav[1];var subscriptionPriceContent=subscriptionPricesCdav.length>2&&subscriptionPricesCdav[0];subscriptionPriceHtml&&$fpPriceSelector&&$fpPriceSelector.html(subscriptionPriceHtml);subscriptionPriceContent&&$fpPriceSelector&&$fpPriceSelector.attr("content",subscriptionPriceContent.replace(",",".").replace("€","").replace(/\s/g,""))}}else{updateUnitPrice(subscriptionUnitPrice,true);updatePackagedPrice(subscriptionPackageUnitPrice,true)}}else{$fpPriceSelector.html(prices[0]);$fpPriceSelector.attr("content",formatPriceForContent(subscriptionPrices[0]));updateUnitPrice(unitPrice,true);updatePackagedPrice(packageUnitPrice,true)}$(".jsClassicPrice",$blocPrice).html(regularPrices[4].replace(" ",""));$(".jsSubscriptionPrice",$blocPrice).html(subscriptionPrices[0].replace(" ",""))}else if(_$dedicatedDeal&&_$dedicatedDeal.length){var dedicatedDealVal=$(".jsFpDedicatedDealRadio:checked",$blocPrice).val();if(dedicatedDealVal==="StandardPrice"){$fpPriceSelector.html(prices[0])}}$optionSel.data("facility");if(facilities.length>3&&$facPrice.length==3){$facPrice.eq(0).text(facilities[1]);$facPrice.eq(1).text(facilities[2]);$facPrice.eq(2).text(facilities[3])}var popPromoPay=$optionSel.data("promopay")||"",$lkPromoPay=$(".jsPromoPay",$blocPrice);popPromoPay.length?$lkPromoPay.attr("onclick","return window.open('"+popPromoPay+"','fpPopup', 'scrollbar=yes,width=550,height=350');").show():$lkPromoPay.hide()}};var checkedVariantSize=[];var selectSizeChange=function(){var $optionSel=$("option:selected",_$selectSize),val=$optionSel.val(),$targetProducts=$(_$fpBlocPrice,_$qaBlocProduct,_$fpWlBloc).find("[data-target-product='"+_$selectSize.data("product")+"']");$optionSel.data("offer")&&$targetProducts.val($optionSel.data("offer"));updateFacility(val);var color=$optionSel.data("color");$("option",_$selectColor).show();color&&$("option:not([value='"+color.replace(/;/g,"'],[value='")+"'], [value='-1'])",_$selectColor).hide();$("li",_$piColor).removeClass("disabled");if(color){$("li:not([data-sku='"+color.replace(/;/g,"'],[data-sku='")+"'])",_$piColor).addClass("disabled")}if(_$fpTop.hasClass("testAjaxVariant")){$.popin.showWaitingOverlay();var alreadyCheck=$.inArray(val,checkedVariantSize)!=-1;if(!alreadyCheck){checkedVariantSize.push(val)}var isProductTemplate=val==-1;var ajaxUrl=$(this).data("action")+'/'+$optionSel.data("offer")+'/'+alreadyCheck+'/'+isProductTemplate+'/'+_isFpRedesign;$.ajax({url:ajaxUrl,type:'GET',dataType:"json",success:function(res){if(res){var $ajaxAssoProductsBlock=$("#fpAjaxAssociatedProduct");var $SelectSize=$(".jsSltSize",$fpAjaxColFloat).html();if(res.stockHtml){$("#fpStock").html(res.stockHtml);loadSzMsg()}if(res.sellByHtml){$("#fpSellBy").html(res.sellByHtml);$(".jsOverlay",$("#fpSellBy")).each(function(){bindOverlays(this)})}if(res.deliveryHtml){var $delivery=_isFpRedesign?$("#fpShipping"):$("#fpDelivery");$delivery.html(res.deliveryHtml);$(".jsOverlay",$delivery).each(function(){bindOverlays(this)});initShipping();initCustomShipping()}if(res.paymentHtml){$("#fpPayment").html(res.paymentHtml);$(".jsOverlay",$("#fpPayment")).each(function(){bindOverlays(this)})}if(res.garserHtml){_$fpGarserZone.html(res.garserHtml);$(".jsOverlay",_$fpGarserZone).each(function(){bindOverlays(this)})}if(res.colFloatHtml){var $fpAjaxColFloat=$("#fpAjaxColFloat");$("#fpAjaxColFloat").html(res.colFloatHtml);var $sltSize=$(".jsSltSize",$fpAjaxColFloat);_$fp=$("#fpContent");_$fpColFloat=$(".jsColFloat",_$fp);_$fpBlocPrice=$("#fpBlocPrice");_$fpTriplePrice=$(".jsTriplePrice",_$fpColFloat);if($sltSize.length>0){$sltSize.html($SelectSize);$sltSize.val(val);$sltSize.change(selectSizeChange);_$selectSize=$sltSize}$(".jsOverlay",_$fpColFloat).each(function(){bindOverlays(this)})}if(res.bottomBlocPrice){$("#qaBlocPrice").html(res.bottomBlocPrice)}if(res.colFloatHtml||res.bottomBlocPrice){initCDAVBloc();initOneClick();initVariantError();loadOffers();loadExpressOffers();loadRimOffers();loadAdDisplay()}if(res.economyHtml){$("#fpAjaxEconomy").show().html(res.economyHtml);$(".jsFpAjaxEconomy",_$fpBlocPrice).show().html(res.economyHtml)}else{$("#fpAjaxEconomy").hide();$(".jsFpAjaxEconomy",_$fpBlocPrice).hide()}if(res.associatedProducts){$ajaxAssoProductsBlock.html(res.associatedProducts)}if(res.fullOdr){$("#fpAjaxFullOdr").html(res.fullOdr)}if(res.descriptionHtml){$("#fpPrdDescBP").html(res.descriptionHtml)}if(res.isMkp){$ajaxAssoProductsBlock.hide()}else{$ajaxAssoProductsBlock.show()}updateProductPrice($optionSel,_$fpBlocPrice);updateProductPrice($optionSel,_$qaBlocProduct);if(_$fpBlocPrice&&_$fpBlocPrice.length){initDedicatedDealBloc(_$fpBlocPrice)}if(_$qaBlocProduct&&_$qaBlocProduct.length){initDedicatedDealBloc(_$qaBlocProduct)}initGarser();initAssembly();initPriceWidth()}},complete:function(ex){$.popin.hideOverlay()}})}else{/true/i.test($optionSel.data("mponly"))&&(_doc.location.href=_$selectSize.data("mpurl"));updateProductPrice($optionSel,_$fpBlocPrice);updateProductPrice($optionSel,_$qaBlocProduct);loadSzMsg()}};var updateFacility=function(size){var selector=" #"+(size!="-1"?size:_sku),$fpCard=$("#fpCard"),$facTit=$fpCard.prev(".fpCard"),$cBlk=$fpCard.add($facTit).add($facTit.prev(".fpTop")),url=$fpCard.data("url")||"/ajax/ProductPaymentFacilityInfoRwd.mvc/";$fpCard.load(url+_sku+selector,function(res){$(selector,res).length?$cBlk.show():$cBlk.hide()})};var updateCustomerReviews=function(url){$.get(url,function(res){if(res){_$bv.html(res);initRating()}})};var updateCustomerReviewsDet=function(url){isResultLoading=true;$.get(url,function(res){if(res){$(".detMainRating",_$bv).html(res);initRating();isResultLoading=false}})};var updateCustomerFAQ=function(url){$.get(url,function(res){if(res){_$faq.html(res);initFAQ()}})};var isResultLoading=false;var initRatingOuterEvent=function(){$(".jsGloTable",_$bv).click(function(){if(!isResultLoading){isResultLoading=true;var selectedFacet=$(this).data('filtre'),$gloTable=$(".jsGloRatingDiv",_$bv),url=$gloTable.data('action'),bvPage=1,allSelectedFilter=$(".jsRatingCount",_$bv).data('selectedfilter'),sortRating=$(".jsSortRating select",_$bv).val();if(allSelectedFilter==''){allSelectedFilter=allSelectedFilter+selectedFacet+";";$(".jsActive",$gloTable).removeClass("jsActive").addClass("jsInactive").addClass("gloRatingInactive");$(this).addClass("jsActive").removeClass("jsInactive").removeClass("gloRatingInactive");$(".selectedBvFilter"+selectedFacet,_$bv).addClass("selectedBvFilterA")}else{if($(this).hasClass("jsInactive")){allSelectedFilter=allSelectedFilter+selectedFacet+";";$(this).addClass("jsActive").removeClass("jsInactive").removeClass("gloRatingInactive");$(".selectedBvFilter"+selectedFacet,_$bv).addClass("selectedBvFilterA")}else{allSelectedFilter=allSelectedFilter.replace(selectedFacet+";","");if(allSelectedFilter==''){$(".jsInactive",$gloTable).addClass("jsActive").removeClass("jsInactive").removeClass("gloRatingInactive")}else{$(this).removeClass("jsActive").addClass("jsInactive").addClass("gloRatingInactive");$(".selectedBvFilter"+selectedFacet,_$bv).removeClass("selectedBvFilterA")}}}url=url+"&page="+bvPage+"&StarValueList="+allSelectedFilter+'&ReviewOrdering='+sortRating;updateCustomerReviewsDet(url)}})};var initRating=function(){var $gloTable=$(".jsGloRatingDiv",_$bv);var $bvPagination=$(".jsBvPagination",_$bv);if($(".jsNoRating",_$bv).length>0){_$faqRatingsZone.addClass("noRating")}var pageCount=$bvPagination.data("pagecount");var currentPage=$bvPagination.data('currentpage');if(currentPage==1){$(".prev",$bvPagination).addClass("btdisable")}else if(currentPage==pageCount){$(".next",$bvPagination).addClass("btdisable")}$(".ratFB",_$bv).click(function(){return win.open($(this).attr("data-fbUrl"),"popup","scrollbars=yes, resizable=yes")});$(".jsYesRat, .jsNoRat",_$bv).click(function(){var $t=$(this),$p=$t.parent(),$yesNo=$(".jsYesRat, .jsNoRat",$p);if(!$p.hasClass("disabled")){$.get("/UpdateCustomerReviewsUsefullness.html/"+$t.hasClass("jsYesRat")+"/"+$t.attr("data-review"),function(res){if(res){$yesNo.hide();$(".jsRatRelevanceValidated",$p).text($t.data("review-result")).fadeIn()}})}});$(".jsRatingReport",_$bv.add(_$faqSocial)).click(function(){var $t=$(this),$p=$t.parent(),$DetRatingP=$t.parents(".jsDetRating"),$star=$DetRatingP.find(".jsSta");var url=$.fn.lnf($t.attr('href'));(new Image).src=url;$t.remove();$(".reported",$p).fadeToggle("fast");$DetRatingP.addClass("deactivatedDetRating");$star.addClass("deactivatedRatingStar");return false});$(".pagNum",_$bv).click(function(event){var elt=event.target||event.srcElement,url=this.getAttribute('data-action'),pge=elt.innerHTML;if($(elt).hasClass('prev')){pge=parseInt($('.on',$(this)).html())-1}else if($(elt).hasClass('next')){pge=parseInt($('.on',$(this)).html())+1}if(!$(elt).hasClass('noClick')){url+='&ReviewOrdering='+$(".pagRating select",_$bv).val();url+='&CurrentPage='+pge;updateCustomerReviews(url)}});$bvPagination.click(function(event){var elt=event.target||event.srcElement,url=this.getAttribute('data-action'),bvPage=$bvPagination.data('currentpage'),allSelectedFilter=$(".jsRatingCount",_$bv).data('selectedfilter'),sortRating=$(".jsSortRating select",_$bv).val();if($(elt).hasClass('prev')&&!$(elt).hasClass('btdisable ')){bvPage--}else if($(elt).hasClass('next')&&!$(elt).hasClass('btdisable ')){bvPage++}url=url+"&CurrentPage="+bvPage+"&StarValueList="+allSelectedFilter+'&ReviewOrdering='+sortRating;updateCustomerReviewsDet(url)});$(".jsSortRating select",_$bv).bind("change",function(){var url=this.getAttribute('data-action'),bvPage=1,allSelectedFilter=$(".jsRatingCount",_$bv).data('selectedfilter'),sortRating=$(".jsSortRating select",_$bv).value;url=url+"&page="+bvPage+"&StarValueList="+allSelectedFilter+'&ReviewOrdering='+this.value;updateCustomerReviewsDet(url)});$(".jsSelectedBvFilter",_$bv).click(function(){if(!isResultLoading){isResultLoading=true;var unSelectedFacet=$(this).data('filtre'),$gloRating=$('.jsGloRatingDiv',_$bv),url=$(this).parent().data('action'),bvPage=1,allSelectedFilter=$(".jsRatingCount",_$bv).data('selectedfilter'),sortRating=$(".jsSortRating select",_$bv).val();allSelectedFilter=allSelectedFilter.replace(unSelectedFacet+";","");url=url+"&page="+bvPage+"&StarValueList="+allSelectedFilter+'&ReviewOrdering='+sortRating;$(this).removeClass("selectedBvFilterA");if(allSelectedFilter==""){$(".jsGloTable",$gloRating).addClass("jsActive").removeClass("jsInactive").removeClass("gloRatingInactive")}else{$(".jsActive[data-filtre="+unSelectedFacet+"]",$gloRating).removeClass("jsActive").addClass("jsInactive").addClass("gloRatingInactive")}updateCustomerReviewsDet(url)}})};var initQAProductBloc=function(){var $header=$(".headerAndMsg",_$headerZone);var updateProductBlocPosition=function(){if(_$faqRatingsZone.length>0&&_$qaBlocProduct.length>0){var headerHeight=$header.css("position")=="fixed"?$header.height():0;var heightOfElement=_$qaBlocProduct.height();var topOfElement=_$faqRatingsZone.offset().top+40;var bottomOfElement=_$faqRatingsZone.offset().top+_$faqRatingsZone.outerHeight();var bottomOfScreen=$(window).scrollTop()+$(window).height();var topOfScreen=$(window).scrollTop()+headerHeight;if((bottomOfScreen>topOfElement)&&(topOfScreen<bottomOfElement)){_$qaBlocProduct.addClass("showQaBlocProduct").removeClass("hiddenQaBlocProduct");if(topOfScreen<topOfElement){_$qaBlocProduct.offset({top:topOfElement})}else if(bottomOfScreen>topOfElement){if(topOfScreen+heightOfElement>bottomOfElement){_$qaBlocProduct.offset({top:bottomOfElement-heightOfElement})}else{if(_$qaBlocProduct.css("position")!="fixed"){_$qaBlocProduct.css("position","fixed")}if(_$qaBlocProduct.css("top")!=headerHeight){_$qaBlocProduct.css("top",headerHeight)}}}}else{_$qaBlocProduct.removeClass("showQaBlocProduct").addClass("hiddenQaBlocProduct")}}};$(window).scroll(updateProductBlocPosition).resize(updateProductBlocPosition);_$qaBlocProduct.on("click",".clickDisabled",function(){var $errorVariant=$("form[name=variantForm] .selMsgVar");if($errorVariant.length>0){$('html, body').animate({scrollTop:$errorVariant.offset().top-250},500)}})};var initFAQ=function(){if($(".jsNoQuestion",_$faq).length>0){_$faqRatingsZone.addClass("noQuestion")}$(".plus, .moins",_$faq).click(function(){var $t=$(this),$p=$t.parent(),$isAnswer=$t.parents(".fpFAQIAns"),$urlVote=(!$isAnswer.length)?"/UpdateCustomerQuestionUsefullness.html/":"/UpdateCustomerResponseUsefullness.html/";if(!$p.hasClass("disabled")){$.get($urlVote+$t.hasClass("plus")+"/"+$t.attr("data-review"),function(res){if(res){$t.html(parseInt($t.html())+1);$p.addClass('disabled')}})}});function hideResultMsg(questionBloc){$(".jsAnswerSent",questionBloc).hide();$(".jsAnswerSentError",questionBloc).hide()}$.fn.sortFAQ=function(pge){var pge=pge||1,url=this[0].getAttribute('data-action');url+='&sortCriteria='+$(".fpFAQSort select",_$faq).val();url+='&searchByKeyword='+$(".fpFAQSrc input[type=text]",_$faq).val();url+='&currentPage='+pge;updateCustomerFAQ(url)};$(".fpFAQSort select",_$faq).bind("change",function(){$(this).sortFAQ()});$(".fpFAQSrc input[type=button]",_$faq).click(function(){$(this).sortFAQ()});$(".fpFAQSrc input[type=text]",_$faq).bind('keydown',function(event){if(event.which===13){$(".fpFAQSrc input[type=button]",_$faq).sortFAQ()}});$(".pagNum",_$faq).click(function(event){var elt=event.target||event.srcElement,pge=elt.innerHTML;if($(elt).hasClass('prev')){pge=parseInt($('.on',$(this)).html())-1}else if($(elt).hasClass('next')){pge=parseInt($('.on',$(this)).html())+1}if(!$(elt).hasClass('noClick')){$(this).sortFAQ(pge)}});$(".jsSniper",_$faq).click(function(){var $t=$(this),$n=$t.nextAll('.jsTarget:first');if($n){$n.find("img[data-src]").lazyload(true);$t.add($n).toggle()}});$.each($(".jsFAQQuestion",_$faq),function(index,element){if($(".fpFAQAnswerClose",element).length>0){$(".jsFAQMoreAnswer",element).removeClass("hiddenCta")}});function toggleAnswerForm(questionBloc,show){if(show){$(".puFm",questionBloc).show();$(".jsFAQPostAnswer",questionBloc).removeClass("hiddenCta");$(".jsFAQCancelAnswer",questionBloc).removeClass("hiddenCta");$(".jsFAQMoreAnswer",questionBloc).addClass("hiddenCta");$(".jsFAQLessAnswer",questionBloc).addClass("hiddenCta");$(".jsFAQAnswerCta",questionBloc).addClass("hiddenCta")}else{$(".puFm",questionBloc).hide();$(".jsFAQPostAnswer",questionBloc).addClass("hiddenCta");$(".jsFAQCancelAnswer",questionBloc).addClass("hiddenCta");$(".jsFAQMoreAnswer",questionBloc).removeClass("hiddenCta");$(".jsFAQAnswerCta",questionBloc).removeClass("hiddenCta");if($(".jsFAQAnswer:not(.fpFAQAnswerClose)",questionBloc).length>1){$(".jsFAQLessAnswer",questionBloc).removeClass("hiddenCta")}}hideResultMsg(questionBloc)}_$faq.on("click",".jsFAQPostAnswer",function(){var $questionBloc=$(this).parents(".jsFAQQuestion");var $form=$(this).parents(".puForm");$.ajax({url:$form.data("action"),type:'POST',data:$form.serialize(),success:function(result){toggleAnswerForm($questionBloc,false);$form.find("textarea").val("");$(".jsAnswerSent",$questionBloc).show()},error:function(ex){$(".jsAnswerSentError",$questionBloc).show()}});return false});_$faq.on("click",".jsFAQCancelAnswer",function(){var $questionBloc=$(this).parents(".jsFAQQuestion");toggleAnswerForm($questionBloc,false)});_$faq.on("click",".jsFAQAnswerCta",function(){var $questionBloc=$(this).parents(".jsFAQQuestion");var login=$.custo.getLogin();var logged=!(login==null||typeof(login.firstName)==="undefined"||login.firstName==="");if(logged){toggleAnswerForm($questionBloc,true)}else{var url=$(this).data("url");window.open(url,'fpPopup','scrollbar=yes,width=1024')}});_$faq.on("click",".jsFAQMoreAnswer",function(){var $questionBloc=$(this).parents(".jsFAQQuestion");var increment=$questionBloc.data("increment");var $closeAnswersList=$(".fpFAQAnswerClose",$questionBloc);for(var i=0;i<increment;i++){$($closeAnswersList[i]).removeClass("fpFAQAnswerClose")}if($closeAnswersList.length<=increment){$(this).addClass("hiddenCta")}$(".jsFAQLessAnswer",$questionBloc).removeClass("hiddenCta");$questionBloc.addClass("fpFAQShowBestAnswer");$questionBloc.data("increment",3);hideResultMsg($questionBloc)});_$faq.on("click",".jsFAQLessAnswer",function(){var $questionBloc=$(this).parents(".jsFAQQuestion");$(".jsFAQAnswer:not(.fpFAQBestAnswer)",$questionBloc).addClass("fpFAQAnswerClose");$questionBloc.removeClass("fpFAQShowBestAnswer");$questionBloc.data("increment",2);$(this).addClass("hiddenCta");$(".jsFAQMoreAnswer",$questionBloc).removeClass("hiddenCta");hideResultMsg($questionBloc)});var $faqPagination=$(".jsFAQPagination",_$faq);var pageCount=$faqPagination.data("pagecount");var currentPage=$faqPagination.data('currentpage');if(currentPage==1){$(".prev",$faqPagination).addClass("btdisable")}else if(currentPage==pageCount){$(".next",$faqPagination).addClass("btdisable")}$faqPagination.click(function(event){var elt=event.target||event.srcElement,url=$(this).data("action"),pge=$(this).data("currentpage");if($(elt).hasClass('prev')){pge=pge-1}else if($(elt).hasClass('next')){pge=pge+1}if(!$(elt).hasClass('noClick')){$(this).sortFAQ(pge)}});$(".jsAnswerReport, .jsQuestionReport",_$faq).click(function(){var $t=$(this),$p=$t.parent();var item=$t.parents(".jsFAQAnswer");if(item.length==0){item=$p.find(".jsFAQQuestionText")}var url=$.fn.lnf($t.attr('href'));(new Image).src=url;$t.remove();$(".reported",$p).fadeToggle("fast");item.addClass("deactivateFAQ");return false});$(".jsPlus, .jsMoins",_$faq).click(function(){var $t=$(this),$p=$t.parent(),$isAnswer=$t.parents(".jsFAQAnswer"),$urlVote=(!$isAnswer.length)?"/UpdateCustomerQuestionUsefullness.html/":"/UpdateCustomerResponseUsefullness.html/",$yesNo=$(".jsPlus, .jsMoins",$p);if(!$p.hasClass("disabled")){$.get($urlVote+$t.hasClass("jsPlus")+"/"+$t.attr("data-review"),function(res){if(res){$yesNo.hide();$(".jsFAQRatValidated",$p).text($t.data("review-result")).fadeIn()}})}})};var initCDAVButton=function(res){var $cdavZone=$("#btnAddUltdDelSub",res);if($.custo&&$.custo.getCdav&&$.custo.getCdav()===true){$cdavZone.remove()}else{$cdavZone.one("click",function(){var currentForm=$(this.form);$cdavZone.addClass("btAdded").val($cdavZone.data("lbladded")||$cdavZone.val());$.ajax({type:"POST",url:currentForm.attr("action"),data:currentForm.add($.contextPage.getTechForm()).serialize(),dataType:"json",success:function(resJson){if(resJson){$.nav&&$.nav.basket&&$.nav.basket.refreshArticlesCount(resJson.NbArticle);resJson.Script&&$.getScript({text:resJson.Script})}}})})}};var initCDAVBloc=function(){var $fpCdavBloc=$(".jsColFloatCdav",_$fpBlocPrice);var $fpAlreadyCdavBloc=$(".jsColFloatAlreadyCdav",_$fpBlocPrice);var $addCdavBasket=$(".jsAddCdavBasket, .jsAddCdavWithVPBasket, .jsAddCdavWithSubscription",_$fpColFloat);var $addCdavWithVP=$(".jsAddCdavWithVP",_$fpTriplePrice);var $CDAVWithVPStep1=$(".jsCDAVWithVPStep1",_$fpTriplePrice);var $CDAVWithVPStep2=$(".jsCDAVWithVPStep2",_$fpTriplePrice);var $CDAVWithVPStep3=$(".jsCDAVWithVPStep3",_$fpTriplePrice);var $NotCDAVMsg=$(".jsMSGNotCDAV",_$fpTriplePrice);var login=$.custo.getLogin();var logged=!(login==null||typeof(login.firstName)==="undefined"||login.firstName==="");var isCdav=$.custo&&$.custo.getCdav&&$.custo.getCdav();$addCdavWithVP.click(function(){$CDAVWithVPStep1.fadeOut();if(logged&&isCdav){$CDAVWithVPStep3.fadeIn(1000);$NotCDAVMsg.hide()}else{$CDAVWithVPStep2.fadeIn(1000)}});$fpCdavBloc.click(function(ev){var el=ev.target;if(el.tagName!="INPUT"&&el.tagName!="A"){$addCdavBasket.trigger("click")}});$addCdavBasket.click(function(){var $isAddCdavToBasketActive=$(".jsIsCdavAddToBasket",_$fpColFloat);if($(this).is(":checked")){$isAddCdavToBasketActive.val(true);$CDAVWithVPStep3.fadeIn(1000);$CDAVWithVPStep2.hide()}else{$isAddCdavToBasketActive.val(false)}});if(logged&&isCdav){$fpAlreadyCdavBloc.show();if(_isSubscriptionAvailable){updateCdavSubscriptionInformation(logged&&isCdav)}}else{$fpCdavBloc.show()}};function updateCdavSubscriptionInformation(isCdav){if(!_isSubscriptionAvailable){return}var $fpPriceSelector=$(".jsMainPrice",_$fpBlocPrice);var $subscriptionUnitPriceSelector=$(".jsPerUnitPrice",_$fpBlocPrice);var subscriptionOption=$(".jsFpSubscriptionRadio:checked",_$subscription);var $subscriptionDiscountSelector=$(".jsSubscriptionDiscountPercentage",_$fpBlocPrice);var $subscriptionPriceSelector=$(".jsSubscriptionPrice",_$fpBlocPrice);if(subscriptionOption.length>0&&subscriptionOption.val()=="Subscription"){var subscriptionDiscount=$subscriptionDiscountSelector&&$subscriptionDiscountSelector.attr("data-subscription-price-cdav")||"";var subscriptionCdavPrice=$subscriptionPriceSelector&&$subscriptionPriceSelector.attr("data-subscription-price-cdav")||"";subscriptionDiscount&&$subscriptionDiscountSelector&&$subscriptionDiscountSelector.html(subscriptionDiscount);subscriptionCdavPrice&&$subscriptionDiscountSelector&&$fpPriceSelector&&$fpPriceSelector.attr("content",(subscriptionCdavPrice.replace(",",".").replace("€","").replace(/\s/g,"")));subscriptionCdavPrice&&$subscriptionDiscountSelector&&$subscriptionPriceSelector;$subscriptionPriceSelector.html(subscriptionCdavPrice.replace(" ",""));updateSubscriptionInformationsCDAV(isCdav);var subscriptionOption=$(".jsFpSubscriptionRadio:checked",_$subscription);if(subscriptionOption.length>0&&subscriptionOption.val()!=""){subscriptionChangeLabels(subscriptionOption.val())}}}function removeEuroSign(str){if(str.indexOf("€")>0){return str.replace("€","")}return str}function extractPriceInformations(separator,price,parsedPrice){var priceInt=Math.floor(parsedPrice);var priceSplit=price.split(separator);var decimals="";if(priceSplit.length>0){decimals=removeEuroSign(priceSplit[1])}return priceInt+"<sup>€"+decimals+"</sup>"}function formatPrice(price){var parsedPrice=parseInt(price);if(price.indexOf(",")>0&&!isNaN(parsedPrice)){return extractPriceInformations(",",price,parsedPrice)}else if(price.indexOf(".")>0&&!isNaN(parsedPrice)){return extractPriceInformations(".",price,parsedPrice)}return price}function changePrice(subscriptionVal){var $fpPriceSelector=$(".jsMainPrice",_$fpBlocPrice);var price;if(subscriptionVal=="Subscription"){price=$(".jsSubscriptionPrice",_$subscription).text()}else{price=$(".jsClassicPrice",_$subscription).text()}$fpPriceSelector.html(formatPrice(price));$fpPriceSelector.attr("content",price.replace(",",".").replace("€","").replace(/\s/g,""))}function updateSubscriptionInformationsCDAV(isChecked){var subscriptionPrice,subscriptionDiscount,subscriptionUnitPrice,subscriptionPackageUnitPrice;var $subscriptionPriceSelector=$(".jsSubscriptionPrice",_$fpBlocPrice);var $subscriptionDiscountSelector=$(".jsSubscriptionDiscountPercentage",_$fpBlocPrice);var $subscriptionUnitPriceSelector=$(".jsPerUnitPrice",_$fpBlocPrice);var $subscriptionPackageUnitPriceSelector=$(".jsPackagingUnitPrice",_$fpBlocPrice);var $variantDdlSelector=$(".jsOptionListVariantPrice option:selected",_$fp);if($variantDdlSelector.length>0&&$variantDdlSelector.val()!="-1"){var variantUnitPrice=$variantDdlSelector.attr("data-unit-price")||"";var regularPrices=($variantDdlSelector.attr("data-price")||"").split(";");var subscriptionPrices=($variantDdlSelector.attr("data-subscription-price")||"").split(";");var subscriptionPricesCdav=($variantDdlSelector.attr("data-subscription-price-cdav")||"").split(";");if(isChecked){subscriptionPrice=(subscriptionPricesCdav.length>2&&subscriptionPricesCdav[0])||(subscriptionPrices.length>2&&subscriptionPrices[0]);subscriptionDiscount=$subscriptionDiscountSelector.attr("data-subscription-price-cdav")||$subscriptionDiscountSelector.attr("data-subscription-price")||"";subscriptionUnitPrice=$variantDdlSelector.attr("data-subscription-cdav-unit-price")||$variantDdlSelector.attr("data-subscription-unit-price")||"";subscriptionPackageUnitPrice=$variantDdlSelector.attr("data-package-subscription-cdav-unit-price")||$variantDdlSelector.attr("data-package-subscription-unit-price")||""}else{subscriptionPrice=subscriptionPrices.length>2&&subscriptionPrices[0];subscriptionDiscount=$subscriptionDiscountSelector.attr("data-subscription-price")||"";subscriptionUnitPrice=$variantDdlSelector.attr("data-subscription-unit-price")||"";subscriptionPackageUnitPrice=$variantDdlSelector.attr("data-package-subscription-unit-price")||""}updateUnitPrice(subscriptionUnitPrice,true);updatePackagedPrice(subscriptionPackageUnitPrice,true)}else{if(isChecked){subscriptionPrice=$subscriptionPriceSelector.attr("data-subscription-price-cdav")||$subscriptionPriceSelector.attr("data-subscription-price")||"";subscriptionDiscount=$subscriptionDiscountSelector.attr("data-subscription-price-cdav")||$subscriptionDiscountSelector.attr("data-subscription-price")||"";subscriptionUnitPrice=$subscriptionUnitPriceSelector.attr("data-subscription-cdav-unit-price")||$subscriptionUnitPriceSelector.attr("data-subscription-unit-price")||"";subscriptionPackageUnitPrice=$subscriptionPackageUnitPriceSelector.attr("data-package-subscription-cdav-unit-price")||$subscriptionPackageUnitPriceSelector.attr("data-package-subscription-unit-price")||""}else{subscriptionPrice=$subscriptionPriceSelector.attr("data-subscription-price")||"";subscriptionDiscount=$subscriptionDiscountSelector.attr("data-subscription-price")||"";subscriptionUnitPrice=$subscriptionUnitPriceSelector.attr("data-subscription-unit-price")||"";subscriptionPackageUnitPrice=$subscriptionPackageUnitPriceSelector.attr("data-package-subscription-unit-price")||""}updateUnitPrice(subscriptionUnitPrice,false);updatePackagedPrice(subscriptionPackageUnitPrice,false)}subscriptionPrice&&$subscriptionPriceSelector&&$subscriptionPriceSelector.html(subscriptionPrice);subscriptionDiscount&&$subscriptionDiscountSelector&&$subscriptionDiscountSelector.html(subscriptionDiscount);var subscriptionOption=$(".jsFpSubscriptionRadio:checked",_$subscription);if(subscriptionOption.length>0&&subscriptionOption.val()!=""){changePrice(subscriptionOption.val())}}$.init("SubscriptionToProduct",function(opt){var $addForm=$("#addForm");$addForm.attr("action",opt.action);$("input[name=basketId]",$addForm).val(opt.shoppingCartId);$("input[name=urlArticle]",$addForm).val(opt.urlArticle);$addForm.submit()});var initSubscriptionBloc=function(res){var $cdavSubscriptionSelector=$(".jsAddCdavWithSubscription",_$subscription);subscriptionChangeLabels=function(subscriptionVal){var $variantPackSelector=$(".jsPackVariantPrice",_$fp);var $variantDdlSelector=$(".jsOptionListVariantPrice option:selected",_$fp);var $cdavSubscriptionSelector=$(".jsAddCdavWithSubscription",_$subscription);var $alreadyCdavSelector=$(".jsColFloatAlreadyCdav.jsColFloatCdav",_$subscription);var alreadyCdav=$alreadyCdavSelector&&$alreadyCdavSelector.length>0;var $alreadyCdavSecondSelector=$(".jsColFloatAlreadyCdav",_$subscription);var alreadyCdav2=$alreadyCdavSecondSelector&&$alreadyCdavSecondSelector.is(":visible");alreadyCdav=alreadyCdav||alreadyCdav2;var isCdav=$cdavSubscriptionSelector.is(":checked")||alreadyCdav;var label;if($variantPackSelector.length>0){var $selectedVariantOption=$(":radio[name=uniqueQuantity]:checked",_$fp);var $selectedVariantOptionCtx=$selectedVariantOption&&$selectedVariantOption.parent();var $selectedVariantOptionDetail=$selectedVariantOptionCtx&&$(".jsPackVariantPrice",$selectedVariantOptionCtx);var variantUnitPrice;var variantPackagingUnitPrice;if(subscriptionVal=="Subscription"){$variantPackSelector.each(function(){if(isCdav){$(this).attr("data-subscription-price-msg-cdav")&&$(this).html($(this).attr("data-subscription-price-msg-cdav"))}else{$(this).attr("data-subscription-price-msg")&&$(this).html($(this).attr("data-subscription-price-msg"))}});if(isCdav){variantUnitPrice=$selectedVariantOptionDetail&&$selectedVariantOptionDetail.attr("data-subscription-cdav-unit-price");variantPackagingUnitPrice=$selectedVariantOptionDetail&&$selectedVariantOptionDetail.attr("data-package-subscription-cdav-unit-price")}else{variantUnitPrice=$selectedVariantOptionDetail&&$selectedVariantOptionDetail.attr("data-subscription-unit-price");variantPackagingUnitPrice=$selectedVariantOptionDetail&&$selectedVariantOptionDetail.attr("data-package-subscription-unit-price")}}else{$variantPackSelector.each(function(){$(this).attr("data-price-msg")&&$(this).html($(this).attr("data-price-msg"))});variantUnitPrice=$selectedVariantOptionDetail&&$selectedVariantOptionDetail.attr("data-unit-price");variantPackagingUnitPrice=$selectedVariantOptionDetail&&$selectedVariantOptionDetail.attr("data-package-unit-price")}updateUnitPrice(variantUnitPrice,true);updatePackagedPrice(variantPackagingUnitPrice,true)}else if($variantDdlSelector.length>0&&$variantDdlSelector.val()!="-1"){var unitPrice,packageUnitPrice;if(subscriptionVal=="Subscription"){if(isCdav){unitPrice=$variantDdlSelector.attr("data-subscription-cdav-unit-price")||"";packageUnitPrice=$variantDdlSelector.attr("data-package-subscription-cdav-unit-price")||""}else{unitPrice=$variantDdlSelector.attr("data-subscription-unit-price")||"";packageUnitPrice=$variantDdlSelector.attr("data-package-subscription-unit-price")||""}}else{unitPrice=$variantDdlSelector.attr("data-unit-price")||"";packageUnitPrice=$variantDdlSelector.attr("data-package-unit-price")||""}updateUnitPrice(unitPrice,true);updatePackagedPrice(packageUnitPrice,true)}else{var $fpPerUnitPriceSelector=$(".jsPerUnitPrice",_$fpBlocPrice);var $fpPackagingUnitPriceSelector=$(".jsPackagingUnitPrice",_$fpBlocPrice);var variantUnitPrice;var variantPackagingUnitPrice;if(subscriptionVal=="Subscription"){if(isCdav){variantUnitPrice=$fpPerUnitPriceSelector&&$fpPerUnitPriceSelector.attr("data-subscription-cdav-unit-price");variantPackagingUnitPrice=$fpPackagingUnitPriceSelector&&$fpPackagingUnitPriceSelector.attr("data-package-subscription-cdav-unit-price")}else{variantUnitPrice=$fpPerUnitPriceSelector&&$fpPerUnitPriceSelector.attr("data-subscription-unit-price");variantPackagingUnitPrice=$fpPackagingUnitPriceSelector&&$fpPackagingUnitPriceSelector.attr("data-package-subscription-unit-price")}}else{variantUnitPrice=$fpPerUnitPriceSelector&&$fpPerUnitPriceSelector.attr("data-unit-price");variantPackagingUnitPrice=$fpPackagingUnitPriceSelector&&$fpPackagingUnitPriceSelector.attr("data-package-unit-price")}updateUnitPrice(variantUnitPrice,false);updatePackagedPrice(variantPackagingUnitPrice,false)}};$(".jsFpSubscriptionRadio",_$subscription).click(function(){var subscriptionVal=$(this).val();var isSubscription=subscriptionVal&&subscriptionVal=="Subscription";if(isSubscription){$("#addForm").attr("action",$("#fpSubscriptionAddBsk").attr("data-action"));$(".jsNotSubscriptionZone",_$fpBlocPrice).each(function(){$(this).hide()});$(".jsSubscriptionZone",_$subscription).fadeIn();$(".jsOverlay input:checked",_$fpGarserZone).prop('checked',false);_$fpGarserZone.addClass("fpHide");changePrice(subscriptionVal);subscriptionChangeLabels(subscriptionVal);if($cdavSubscriptionSelector.length>0){var $alreadyCdavSelector=$(".jsColFloatAlreadyCdav.jsColFloatCdav",_$subscription);var alreadyCdav=$alreadyCdavSelector&&$alreadyCdavSelector.length>0;var $alreadyCdavSecondSelector=$(".jsColFloatAlreadyCdav",_$subscription);var alreadyCdav2=$alreadyCdavSecondSelector&&$alreadyCdavSecondSelector.is(":visible");alreadyCdav=alreadyCdav||alreadyCdav2;var isClicked=$cdavSubscriptionSelector.is(":checked");updateSubscriptionInformationsCDAV(isClicked||alreadyCdav)}}else{_$fpGarserZone.removeClass("fpHide");$("#addForm").attr("action",$("#fpAddBsk").attr("data-action"));$(".jsSubscriptionZone",_$subscription).hide();$(".jsNotSubscriptionZone",_$fpBlocPrice).each(function(){$(this).fadeIn()});changePrice(subscriptionVal);subscriptionChangeLabels(subscriptionVal)}setAddToBasketFormAction(isSubscription)});setAddToBasketFormAction=function(isSubscription){var $formActionSelector=$(".jsMainForm",_$fpColFloat);var action;if(isSubscription){action="/BasketUC.mvc/AddSubscriptionProduct"}else{action="/ShoppingCartUC.mvc/RWDUpdateProductSheetFormToAddProductOrOfferToShoppingCartFromAjax"}$formActionSelector&&$formActionSelector.length>0&&action&&$formActionSelector.attr("action",action)};$cdavSubscriptionSelector.change(function(){var $subscriptionValueSelector=$(".jsFpSubscriptionRadio:checked",_$subscription);var $alreadyCdavSelector=$(".jsColFloatAlreadyCdav.jsColFloatCdav",_$subscription);var alreadyCdav=$alreadyCdavSelector&&$alreadyCdavSelector.length>0;if($subscriptionValueSelector.length>0&&$subscriptionValueSelector.val()=="Subscription"&&!alreadyCdav){isChecked=$(this).prop('checked');updateSubscriptionInformationsCDAV(isChecked)}subscriptionChangeLabels($subscriptionValueSelector.val())});if($cdavSubscriptionSelector.length>0&&$cdavSubscriptionSelector.prop('checked')){updateSubscriptionInformationsCDAV(true);subscriptionChangeLabels('Subscription')}};var initRentalBloc=function(res){var $rentalRadio=$('.jsFpRentalRadio',_$rental);$rentalRadio.change(function(){var $rentalPriceBlock=$('.jsFpRentalPriceBloc',_$fpBlocPrice);var $purchasePriceBlock=$('.jsFpPurchasePriceBloc',_$fpBlocPrice);var $btnRental=$('.fpBtnAddRental',_$fpBlocPrice);var $btnAddToBasket=$('.fpBtnAddBasket',_$fpBlocPrice);var $rentalReinsuranceBloc=$('.jsFpRentalReinsuranceBloc',_$fpBlocPrice);if($(this)[0].value=='Rental'){$purchasePriceBlock.hide();$rentalPriceBlock.fadeIn();$rentalReinsuranceBloc.slideToggle(1000)}else{$rentalPriceBlock.hide();$purchasePriceBlock.fadeIn();$rentalReinsuranceBloc.slideToggle(1000)}var $selectedChoice=$(this).closest('.jsFpRentalChoice');$selectedChoice.addClass('fpSelectedRentalChoice');var $otherChoice=$('.jsFpRentalChoice',_$rental).not($selectedChoice);$otherChoice.removeClass('fpSelectedRentalChoice')})};var initDedicatedDealBloc=function(_$bloc){var $jsDdPrice=$(".jsDedicatedDealPrice",_$bloc),$jsStdPrice=$(".jsStandardPrice",_$bloc),$fpPriceSelector=$(".jsProductPrice",_$bloc),$jsDdConnectZone=$(".jsDedicatedDealConnectZone",_$bloc),$jsCdav=$(".jsCdavDedicatedDeal",_$bloc),$jsDdZone=$(".jsDedicatedDealZone",_$bloc),$jsNotDdZone=$(".jsNotDedicatedDealZone",_$bloc),$jsDdRadio=$(".jsFpDedicatedDealRadio",_$bloc),$jsDdStandardPrice=$(".jsDedicatedDealStandardPrice",_$bloc),$jsStandardRadio=$(".jsFpDedicatedDealRadio[value='StandardPrice']",_$bloc),$jsDedicatedRadio=$(".jsFpDedicatedDealRadio[value='DedicatedDealPrice']",_$bloc),$jsAddDeal=$(".jsAddDedicatedDeal",_$bloc),$jsDedicatedDealEco=$(".jsDedicatedDealEco",_$bloc),$jsIsWithCdav=$(".jsIsDedicatedDealWithCdav",_$bloc),$jsDealAddCdavBasket=$(".jsDealAddCdavBasket",_$bloc);var updatePrices=function(dedicatedDealVal){var price=dedicatedDealVal=="DedicatedDealPrice"?$jsDdPrice.html():$jsStdPrice.html();$fpPriceSelector.html(price);$fpPriceSelector.attr("content",price.replace(",",".").replace("€","").replace(/\s/g,""));var $jsEcoBlock=$("#fpZnPrdMain .jsEcoBlk>span");if($jsEcoBlock&&$jsEcoBlock.length){var economy=$(".jsFpDedicatedDealRadio:checked",_$bloc).data("eco");$jsEcoBlock.html(economy)}};$jsDdRadio.change(function(){var dedicatedDealVal=$(".jsFpDedicatedDealRadio:checked",_$bloc).val();if(!dedicatedDealVal)return;updatePrices(dedicatedDealVal);if(dedicatedDealVal=="DedicatedDealPrice"){$jsDdZone.fadeIn();$jsNotDdZone.hide()}else{$jsDealAddCdavBasket.prop("checked",false);$jsIsWithCdav.val(false);$jsDdZone.hide();$jsNotDdZone.fadeIn()}});$jsDealAddCdavBasket.click(function(){$jsIsWithCdav.val($(this).is(":checked"))});$jsAddDeal.click(function(){var clientAuthState=getClientAuthState();var isNotValid=!clientAuthState.hasCdav&&!$jsDealAddCdavBasket.is(":checked");$jsDdZone.handleCustomErrors(isNotValid);if(isNotValid)return false;return $(this.form).addToBasket($('form[name=associatedProductsForm], form[name=garserProductsForm], form[name=variantForm], form[name=AssemblyProductsForm]'))});var getClientAuthState=function(){var login=$.custo.getLogin();var isNotLogged=login==null||typeof(login.firstName)==="undefined"||login.firstName==="";return{isNotLogged:isNotLogged,hasCdav:!isNotLogged&&$.custo&&$.custo.getCdav&&$.custo.getCdav()===true}};var clientAuth=getClientAuthState();$jsDdConnectZone.toggle(clientAuth.isNotLogged);$jsCdav.toggle(!clientAuth.hasCdav);if(clientAuth.hasCdav){$jsDdStandardPrice.addClass("fpDedicatedDealDisabled")}else{$jsDdStandardPrice.removeClass("fpDedicatedDealDisabled")}$jsStandardRadio.prop("disabled",clientAuth.hasCdav);$jsStandardRadio.prop("checked",!clientAuth.hasCdav);$jsDedicatedRadio.prop("checked",clientAuth.hasCdav);$jsDdRadio.trigger("change");$.fn.handleCustomErrors=function(disable){var $bt=$(".jsAddDedicatedDeal",this),$msg=$(".variantMsg",this);if(disable==true){$msg.fadeTo("fast",1);$bt.addClass("clickDisabled")}else if(disable==false){$msg.fadeTo("fast",0);$bt.removeClass("clickDisabled")}};$jsAddDeal.on("mouseover",function(){var clientAuthState=getClientAuthState();$jsDdZone.handleCustomErrors(!clientAuthState.hasCdav&&!$jsDealAddCdavBasket.is(":checked"))});$jsAddDeal.on("mouseout",function(){$jsDdZone.handleCustomErrors(false)})};$(".jsFpColFloatGarserBloc",_$fpBlocPrice).click(function(ev){var el=ev.target;if(el.tagName!="INPUT"&&el.tagName!="A"){$("input[type='checkbox']",$(this)).trigger("click")}});initGarser();initAssembly();initPriceWidth();$("#bc .jsBack a").click(function(){if(_doc.referrer&&RegExp(win.location.hostname.concat('(?!.*\/r2-).*')).test(_doc.referrer.split("?")[0])&&win.history.length>1){win.history.go(-1);return false}});var _$szAc=_$sz.data("action");_$szAc&&win.setTimeout(function(){loadSzMsg=function(){var zdsMsgUrl=_$szAc+_sku+" #"+((_$selectSize.val()&&_$selectSize.val()!=="-1")?_$selectSize.val():_sku);_$sz.load(zdsMsgUrl,function(res){_$sz.css("opacity","0").html()&&_$sz.fadeTo("slow","1")})};loadSzMsg()},5e3);if(_$selectSize.val()!=="-1"){_$selectSize.val("-1")}_$selectSize.change(selectSizeChange);if(_doc.location.hash){var hashSize=_doc.location.hash.replace("#",""),sizeSltVal=_$selectSize.find("option").filter(function(index){return hashSize===$(this).text()}).attr("selected","selected");sizeSltVal.length&&selectSizeChange()}var loadOffers=function(options){var settings=options||{};settings.offersListContent=settings.offersListContent||$("#offerOrCds");settings.offersListBlock=settings.offersListBlock||{};settings.highlightSellerId=settings.highlightSellerId||-1;var $offerOrCds=settings.offersListContent,urlOffers=$offerOrCds.data("url"),$offers=$(".jsFpOffer",fpContent);if(settings.highlightSellerId!=-1){urlOffers=urlOffers+"&sellerIdOfferExpressHighlight="+settings.highlightSellerId}if(urlOffers){$.ajax({url:urlOffers,cache:false,dataType:"json",type:'GET',success:function(res){if(res){if(res.RedirectUrl!=null){if(stopAjaxLoop(res.RedirectUrl)){return}window.location.href=res.RedirectUrl}else if(!res.html&&$offers.length){$offers.toggle(150)}else{$offerOrCds.append(res.html);var $offersListBlock=settings.offersListBlock;if($offersListBlock.length){$offersListBlock.removeClass("dn");var $expressLegalNotice=$("#expressLegalNotice");if($expressLegalNotice.length>0&&$expressLegalNotice.html()==""){$expressLegalNotice.append(res.htmlLegalNotice);$expressLegalNotice.removeClass("dn")}}}}}})}};loadOffers();var stopAjaxLoop=function(url){url=url.toLowerCase();var qmIndex=url.indexOf("?");if(qmIndex>0){var canonical=url.substr(0,qmIndex);var qs=url.substr(qmIndex+1);var key=canonical.substr(canonical.lastIndexOf("/"));if(qs&&key){var params=qs.split("&");var offerIdQs="idOffre=".toLowerCase();var offerId="";for(var i=0;i<params.length;i++){if(params[i].indexOf(offerIdQs)==0){offerId=params[i].substr(offerIdQs.length)}}if(offerId!=""){if(hasOfferBeenViewed(offerId)){return true}appendOffer(offerId)}}}return false};var hasOfferBeenViewed=function(offerId){if(sessionStorage&&JSON){var sstOffers=sessionStorage.getItem("cds.offers")||"[]";if(sstOffers){var viewedOffers=JSON.parse(sstOffers);if(viewedOffers&&$&&$.isArray(viewedOffers)&&viewedOffers.length>0){for(var i=0;i<viewedOffers.length;i++){if(viewedOffers[i]==offerId){return true}}}}}return false};var appendOffer=function(offerId){if(sessionStorage&&JSON){var sstOffers=sessionStorage.getItem("cds.offers")||"[]";if(sstOffers){var viewedOffers=JSON.parse(sstOffers);if(!viewedOffers||!$||!$.isArray(viewedOffers)){viewedOffers=[]}viewedOffers.push(offerId);sessionStorage.setItem("cds.offers",JSON.stringify(viewedOffers))}}};var loadExpressOffers=function(){var _$offersListBlock=$("#offerOrCdsExpress").closest(".jsOffersListBlock"),_$offersListContent=$("#offerOrCdsExpress"),_$hiddenSellers=$("#expressSellersHighlight");var cookieElements=$.cookies.get("SitePersoCookie").split("__"),globalSellerId=cookieElements[cookieElements.indexOf("ExpressGlobalSellerId")+1];if(_$hiddenSellers.length){var sellers=_$hiddenSellers.val().split(";");if(globalSellerId&&($.inArray(globalSellerId,sellers)>-1)){loadOffers({offersListBlock:_$offersListBlock,offersListContent:_$offersListContent,highlightSellerId:globalSellerId})}}};loadExpressOffers();var loadRimOffers=function(){loadOffers({offersListBlock:$("#nearestRimOfferBlock"),offersListContent:$("#nearestRimOffer")})};loadRimOffers();(function(){var $zoneZoom=$(".fpMainImg",_$fpPrdMain),imgSizePattern=(/\/(\d+x\d+)\//ig.exec($("a",$zoneZoom).attr("href"))||[])[1],$smlImg=$(".jsSmallImg",_$fpPrdMain),$baseUrl,zoomExt=$([]),_mainUrl,imgList=$(".fpZoomPic img",_$fpPrdMain),nextImg=$(".jsNextImage",_$fpPrdMain),previousImg=$(".jsPreviousImage",_$fpPrdMain);var _mainImgChange=function(url){var format=$smlImg.attr("src").match(/\d{3}x\d{3}/)[0];if(url!=null){$("source",$smlImg.parent()).each(function(){var format=this.getAttribute("srcset").match(/\d{3}x\d{3}/)[0];this.setAttribute("srcset",url.replace(/\d{3}x\d{3}/,format))});$smlImg.attr("src",url.replace(/\d{3}x\d{3}/,format))}};var smlImgSrc=($smlImg.length&&$smlImg.attr("src"))?$smlImg.attr("src"):"";zoomExt=$zoneZoom.zoom($("#fpZoomWindow")).setBigImg(smlImgSrc.replace(/\d{3}x\d{3}/,imgSizePattern));var tag=$(".fpZoom, .fpMainImg",_$fpPrdMain).data("zoommethod");if(!tag||$.isTouch()){$(".fpZoom, .fpMainImg, .jsSmallImg",_$fpPrdMain).click(function(){var url=$(this).parent().data("zurl")||("/Product/Zoom/"+_sku+"/0.html");return win.open(url,"zoom","scrollbar=yes")})}$(".fpZoomPic",_$fpTop).on("mouseover touchstart",function(event){$(".fpZoomPic",_$fpTop).removeClass("act");var $t=$(this);$t.addClass("act");_mainUrl=$("img",$t).attr("src");if(_mainUrl){_mainImgChange(_mainUrl);zoomExt.setBigImg(_mainUrl.replace(/\d{3}x\d{3}/,imgSizePattern));changeArrowOpacity()}});var changeArrowOpacity=function(){if(imgList[0].src==_mainUrl){previousImg.addClass("arrowLowOpacity")}else{previousImg.removeClass("arrowLowOpacity")}if(imgList[imgList.length-1].src==_mainUrl){nextImg.addClass("arrowLowOpacity")}else{nextImg.removeClass("arrowLowOpacity")}};if($.isTouch()){if(imgList.length>1){nextImg.show();previousImg.show()}}else{$(".fpImgLightMain").hover(function(){if(imgList.length>1){nextImg.show();previousImg.show()}},function(){nextImg.hide();previousImg.hide()})}var findImgIndex=function(currentSrc){for(var i=0;i<imgList.length;i++){if(imgList[i].src.replace(/\d{3}x\d{3}/,imgSizePattern)===currentSrc.replace(/\d{3}x\d{3}/,imgSizePattern)){return i}}};var changeImgWithArrow=function(imageNextPosition){var currentIndex=findImgIndex($(".jsSmallImg").attr("src"));if(currentIndex+imageNextPosition<imgList.length&&currentIndex+imageNextPosition>=0){$(".fpZoomPic")[currentIndex].classList.remove("act");$(".fpZoomPic")[currentIndex+imageNextPosition].classList.add("act");_mainUrl=imgList[currentIndex+imageNextPosition].src;_mainImgChange(imgList[currentIndex+imageNextPosition].src);changeArrowOpacity()}};nextImg.click(function(){changeImgWithArrow(1)});previousImg.click(function(){changeImgWithArrow(-1)});(function(){var _baseColor,$colorName=$(".jsColName",_$fpTop),active=false;$("ul.jsPiColor, ul.jsPiHTColor",_$fpTop).hover(function(ev){if(!_mainUrl){_mainUrl=$smlImg.attr("src")}_baseColor=$colorName.html()},function(){$(".jsColName",$(this).prev()).html(_baseColor);_mainImgChange(_mainUrl)}).on("mousemove","li",function(ev){var $t=$(this),$parent=$t.parent();_mainImgChange($("img",$t).attr("src"));if($t.is(".disabled")){$colorName.html($parent.data("lbl-disabled"))}else{$colorName.html($t.data("lbl-color"))}})})()})();(function(){var $VariationName=$(".jsVariationName",_$fpTop),_baseVariation;$(".fpVariationGroup ul.hVariationGroup li",_$fpTop).hover(function(ev){_baseVariation=$VariationName.html()},function(){$VariationName.html(_baseVariation)}).on("mousemove","a",function(ev){var $t=$(this);if($('.jsPackagingValue').length>0){$t=$t.find('.jsPackagingValue')}$VariationName.html($t.text())})})();$(".jsGomette",_$fpPrdMain).click(function(){var $t=$(this),$nxt=$t.next().show(),$eco=$(".ecoBlk",_$fpPrdMain).hide(),srcImg=$nxt.data("bg");if(srcImg){var img=new Image;img.src=srcImg;$(img).load(function(){$nxt.css("background-image","url('"+srcImg+"')").data("bg","").removeClass("dn");$eco.hide()})}else{$nxt.removeClass("dn");$eco.hide()}$nxt.show().one("click",function(){$nxt.addClass("dn");$eco.removeClass("dn").show();return false});return false});$(".fpZnPrd",_$fp).one("mouseenter",function(){$.getScript("http://apis.google.com/js/plusone.js")});function bindOverlays(context){openOverlay($('.fpLk:first',context),$('.fpOverBlk',context));openOverlay($('.jsFpClickLk:first',context),$('.jsfpOverlayContent',context));openOverlay($('.jsFpBaLk:first, .jsFpLk:first',context),$('.jsFpBaOverBlk',context))}$(".jsOverlay",_$fp).each(function(){bindOverlays(this)});$(".jsStarOverlay",_$fpTop).each(function(){var $t=$(this);openOverlay($t,$('.fpOverBlk',$t.parent()))});$(".jsCountdown, .countdown",_$fpTop).countDown({callbackEnd:function(){var $t=$(this);if($t.is(".jsEndStress")){var $parent=$t.parent();$parent.next().show();$parent.remove();$('.jsStressDeliveryFpRedesign').remove()}}});(function(){var $progressBg=$(".jsProgressBg",_$fpTop);$progressBg.animate({width:$progressBg.data("width")},2e3)})();_$selectCond.change(function(ev){var $t=$(this),target=ev.target,_$selection=$("input:checked",target),url=$("option:selected",target).data("action")||_$selection.parents("li").data("action");if(url){_doc.location.href=url}else{var $inp=$("input[id*='PackagingId']");$inp.val(target.value);$inp[0].form.submit()}});_$selectColor.change(function(){var size=_$selectSize.val(),hf=(size&&size!="-1")?"#"+$("option:selected",_$selectSize).text():"";_doc.location.href=$("option:selected",$(this)).data("action")+hf});if(_isFpRedesign){$(".jsShowVariant",_$fp).click(function(){$(this).addClass("fpHiddenVariant");$(".jsHiddenVariant",_$fp).removeClass("fpHiddenVariant").css({opacity:0}).animate({opacity:1},800)});$(".jsHideVariant",_$fp).click(function(){$(".jsHiddenVariant",_$fp).addClass("fpHiddenVariant");$(".jsShowVariant",_$fp).removeClass("fpHiddenVariant").css({opacity:0}).animate({opacity:1},800)})}$(".jsShowHVariant",_$fpColFloat).click(function(){$(this).addClass("fpHiddenVariant");$(".jsHiddenVariant",_$fpColFloat).removeClass("fpHiddenVariant").css({opacity:0}).animate({opacity:1},800)});$(".jsHiddenHVariant",_$fpColFloat).click(function(){$(".jsHiddenVariant",_$fpColFloat).addClass("fpHiddenVariant");$(".jsShowHVariant",_$fpColFloat).removeClass("fpHiddenVariant").css({opacity:0}).animate({opacity:1},800)});$(".jsShowRating",_$fpColFloat).click(function(){var $p=$(this).parent();$p.hide();$p.prev().show()});$(".jsHideRating",_$fpColFloat).click(function(){var $p=$(this).parent();$p.hide();$p.next().show()});$(".jsShowUsedProductComment",_$fpCommentOnTop).click(function(){var $p=$(this).parent();$p.hide();$p.prev().show()});$(".jsHideUsedProductComment",_$fpCommentOnTop).click(function(){var $p=$(this).parent();$p.hide();$p.next().show()});$("li",_$piColor).click(function(){var size=_$selectSize.val(),hf=(size&&size!="-1")?"#"+$("option:selected",_$selectSize).text():"";if(!$(this).hasClass("jsHiddenHVariant")&&!$(this).hasClass("jsShowHVariant")){_doc.location.href=$(this).data("action")+hf}});$(".fpTopGar",_$fpTop).click(function(ev){var el=ev.target;if(el.tagName=="INPUT"){$("input[type=checkbox]",".fpTopGar").not(el).removeAttr("checked")}});updateFacility(_$selectSize.val()||"-1");$(".fpIpdtMore",_$fp).click(function(){$("p",$(this).toggleClass("open")).slideToggle("fast")});$("#fpIndP .jsSltSize, #fpAssMain .jsSltSize").change(function(){var $select=$("option:selected",this),prices=($select.data("price")||"").split(";"),$block=$(this).parents("div:eq(1)"),$apartir=$(".jsPriceInfo",$block);$(".price",$block).html(prices[0]);$(".stroken",$block).html(prices[1]);prices[2]?$(".fpEco, .ecoBlk",$block).html(prices[2]).removeClass("dn").show():$(".fpEco, .ecoBlk",$block).hide();$apartir&&$select.val()==="-1"?$apartir.removeClass("dn"):$apartir.addClass("dn")});$(".jsSltSize, .jsSltColor, .jsSltCond",_$assoProducts).change(function(){var $select=$("option:selected",this),prices=($select.data("price")||"").split(";"),$block=$(this).parents("li"),$apartir=$(".jsPriceInfo",$block),src=$select.data("imgsrc"),index=$block.index(),$item=$(".jsAssoPrdtPic >li:eq("+index+")",_$assoProducts);$(".price",$block).html(prices[0]);$(".stroken",$block).html(prices[1]);$apartir&&$select.val()==="-1"?$apartir.removeClass("dn"):$apartir.addClass("dn");$("input[type=checkbox]",$block).prop("checked",true);if($item.length){if(src){$("img",$item).attr("src",src)}if($select.val()!=-1){$(".jsAssoAdded",$item).removeClass("dn")}}});var $blocBulletPoint=$("#fpBulletPointReadMore");var $MoreAndLess=$('.jsButtonReadMore',$blocBulletPoint);var $MoreAndLessImg=$(".jsFpReadMoreAndLessImg",$blocBulletPoint);var $Transparence=$(".jsFpCacheTransparent",$blocBulletPoint);var nbLi=$(".jsFpBulletPointMore li",$blocBulletPoint).length;var textHide=$MoreAndLess.data("hide");var textShowAll=$MoreAndLess.data("showall");$(".jsFpBulletPointMore",$blocBulletPoint).hide();if(nbLi==0){$Transparence.hide();$MoreAndLessImg.hide();$MoreAndLess.hide()}$MoreAndLess.click(ShowBulletPoints);$Transparence.click(ShowBulletPoints);function ShowBulletPoints(){$(".jsFpBulletPointMore",$blocBulletPoint).slideToggle(1000);if($MoreAndLess.text()==textShowAll){$Transparence.hide();$MoreAndLessImg.addClass("fpReadMoreAndLessImgRotate");$MoreAndLess.text(textHide)}else{$Transparence.show();$MoreAndLessImg.removeClass("fpReadMoreAndLessImgRotate");$MoreAndLess.text(textShowAll)}}$(".fpDescBun + table tr:nth-child(n+11)",_$fp).hide();$(".fpBtnBun",_$fp).click(function(){$t=$(this);$("tr:nth-child(n+11)",$t.prev("table")).toggle();$("span",$t).toggle()});initRatingOuterEvent();initRating();initFAQ();initQAProductBloc();$("#fpSimTab").click(function(ev){var $t=$(ev.target);$t.siblings().addClass("inact").removeClass("active");$t.removeClass("inact").addClass("active");$(".fpSimilar",$(ev.currentTarget).next()).addClass("dn").eq($t.index()).removeClass("dn").find("img[data-src]").lazyload(true);return false});$("img[data-src]",_$fp).lazyload();$.storage.set("fpBack","1");var $caroussel=$("#caroussel");if($caroussel.length){$caroussel.carouselSwipe()}function initVariantError(){var $select=$(".jsSltSize, .jsSltColor, .jsSltCond",_$fpTop),$msgBox=$(".jsMsgVar, .jsNewMsgVar",_$fpTop),$mainItemToCheck=$(".jsSltSize, .jsSltColor, .jsSltCond",_$fpTop),$fpOneCk=$("#fpOneCk, #fpOneCkBottom"),$fpIpdtArea=$(".fpIpdtArea",_$fp).add($(".jsAssoPrdtLines > li",_$assoProducts)),$checkZones=_$fpColFloat.add(_$qaBlocProduct);$checkZones.on("mouseover",".jsMainForm .jsValidForm",function(){$(this.form).checkFormErrors($mainItemToCheck)});$checkZones.on("mouseover",".jsOneCkForm .jsValidForm",function(){$(this.form).checkFormErrors($mainItemToCheck.add($(".jsOneCkAddr",$fpOneCk)))});$checkZones.on("mouseout",".jsValidForm",function(){$(this.form).ckDisability(false)});if($msgBox.length){$select.change(function(){$(this).removeClass("selMsgVar");if($select.filter(function(){return this.value==-1}).length){$(".jsSltSize",$select).val()==-1?$msgBox.removeClass("gt"):$msgBox.removeClass("lt")}else{$msgBox.hide();$msgBox.removeClass("gt lt")};});$fpIpdtArea.each(function(){var $t=$(this),$mesVar=$(".jsMsgVar",$t);$("input[type=checkbox]",$t).click(function(){var $s=$("select",$t);if($s.val()=="-1"){if(this.checked){$mesVar.show(0,function(){$(this).addClass("show").html(popinMsgVariant.acc.format($("option:selected",$s).text()))});$("select",$t).addClass("selMsgVar");return false}}else{var $label=$(this).parents("label"),$span=$("span",$label),$block=$(this).parents("li"),index=$block.index(),$item=$(".jsAssoPrdtPic >li:eq("+index+")",_$assoProducts);$span.html($label.hasClass("checked")?$span.data("txt"):$span.data("check"));$label.toggleClass("checked");if($item.length){$(".jsAssoAdded",$item).toggleClass("dn")}}});$("select",$t).change(function(){var $t=$(this);$t.removeClass("selMsgVar").find("option").filter(function(){return this.value==-1}).remove();$mesVar.hide(0,function(){$mesVar.removeClass("show")})})});$.addToBasketValidate=[function(mainForm){var $select=$(".jsSltSize, .jsSltColor, .jsSltCond",_$fpTop),$selectErr=$select.filter(function(){var isSelected;if(this.value){isSelected=this.value!=-1}else{isSelected=$(this).data("value")}return!isSelected}).addClass("selMsgVar"),$msgBox=$(".jsMsgVar",_$fpTop),msg="";$msgBox.removeClass("lt gt");if($selectErr.length){$msgBox=$(".jsMsgVar",_$fpTop);if($selectErr.length>1){msg=popinMsgVariant.sizeColor;$msgBox.addClass("lt gt")}else if($selectErr.filter(".jsSltSize").length){msg=popinMsgVariant.size;$msgBox.addClass("lt")}else if($selectErr.filter(".jsSltColor").length){msg=popinMsgVariant.color;$msgBox.addClass("gt")}else if($selectErr.filter(".jsSltCond").length){msg=popinMsgVariant.cond;$msgBox.addClass("lt")}$msgBox.text(msg).fadeTo("fast",1);var $msgToScroll=$msgBox.filter(":visible:first"),$win=$(win),h=$msgToScroll.offset().top+5*$msgToScroll.innerHeight()-($win.height()+$win.scrollTop());if(h>0){$("html, body").animate({scrollTop:h+$win.scrollTop()},"fast")}}return!$selectErr.length}];$.addToBasketValidate.push(function(){var msgAcc="",isValide=true;$fpIpdtArea.filter(function(){return $(this).find("option:selected[value='-1'], input:checked").length>=2}).each(function(){var t=this,$mesVar=$(".jsMsgVar",t),$s=$("select",t);$("html, body").animate({scrollTop:$(t).offset().top},0,function(){$mesVar.show(0,function(){$(this).addClass("show").html(popinMsgVariant.acc.format($("option:selected",$s).text()))})});isValide=false});return isValide})}else{$(".fpIpdtArea input, .jsAssoPrdtLines input[type=checkbox]",_$fp).click(function(){var $label=$(this).parents("label"),$span=$("span",$label),$block=$(this).parents("li"),index=$block.index(),$item=$(".jsAssoPrdtPic >li:eq("+index+")",_$assoProducts);$span.html($label.hasClass("checked")?$span.data("txt"):$span.data("check"));$label.toggleClass("checked");if($item.length){$(".jsAssoAdded",$item).toggleClass("dn")}});$.addToBasketValidate.push(function(){var msgAcc="",isValide=true;$(".fpBlkDbl input:checked, #fpAssMain input:checked, .fpIndisPdt input:checked",_$fp).each(function(){msgAcc==""&&$(this).parents("div:eq(1)").find("select").each(function(){if(this.value==="-1"){msgAcc=(popinMsgVariant.acc).format($("option:selected",this).text());$.popin.alert(msgAcc,{btnTxt:popinMsgVariant.btnTxt});isValide=false;return(isValide=false)}})});return isValide})}};initVariantError();(function(){var $fpSOForm=$("#fpSOForm form"),$email=$("input[type=text]",$fpSOForm);if($.nav.session.isAuthenticate()){$email.val($.custo.getEmail())}$fpSOForm.submit(function(){if($email.val().length>1){var $form=$(this);$.ajax({type:"GET",url:$form[0].action,dataType:"json",data:$form.serialize(),success:function(res){if(res){$.getScript({text:res.script});if(res.success){$fpSOForm.html(res.message)}else{$("#fpSOFormError").html(res.message)}}}})}return false})})();(function(){var $fpAlertForm=$("#fpAlertForm form"),$email=$("input[type=text]",$fpAlertForm);if($.nav.session.isAuthenticate()){$email.val($.custo.getEmail())}$fpAlertForm.submit(function(){if($email.val().length>1){var $form=$(this);$.ajax({type:"GET",url:$form[0].action,dataType:"json",data:$form.serialize(),success:function(res){if(res){$.getScript({text:res.script});$("#fpAlertMailRes").html(res.message)}}})}return false})})();function initOneClick(){var $oneCk=$("#fpOneCk, #fpOneCkBottom"),urlCk=$oneCk.data("url-oneck-init"),checkUrl=$oneCk.data("url-oneck-adr"),$dataLoad=$("form:not(.jsOneCkForm)",_$fpBlocPrice);$oneCk.on("change","select",function(){var $form=$(this.form).add($dataLoad);if(this.value!="-1"){$(".jsOverBP",$oneCk).fadeIn();$.ajax({type:"POST",url:checkUrl,data:$form.serialize(),success:function(res){if(res){$oneCk.html(res)}},error:function(){var $oneCkSelect=$("#fpOneCk .jsOneCkAddr, #fpOneCkBottom .jsOneCkAddr");$oneCkSelect.val(-1);$oneCkSelect.addClass("selMsgVar")},complete:function(){}})}else{var $oneCkSelect=$("#fpOneCk .jsOneCkAddr, #fpOneCkBottom .jsOneCkAddr");$oneCkSelect.val(-1);$oneCkSelect.addClass("selMsgVar")}});if($oneCk.length){$.custo.addListener(function(){$.post(urlCk,$dataLoad.serialize(),function(res,sta,xhr){if(res){$oneCk.html(res);initSessionId();var $noOneCk=$("#fpAssMain").add($(".jsNoOneCk",_$fpTop));$noOneCk.click(function(){if($("input:checked",$noOneCk).length>0){$oneCk.hide()}else{$oneCk.show()}})}})})}};initOneClick();function loadAdDisplay(){var $adDisplay=$(".jsColFloatAdDisplay",_$fpColFloat),urlAdDisplay=$adDisplay.data("action");if(urlAdDisplay){var widgetName=$adDisplay.data("widget"),missedAdsInfos=[],isMiss=true;$.post(urlAdDisplay,function(res,sta,xhr){if(res){if(res.html){$adDisplay.html(res.html);if($adDisplay.has(".jsOverlay")){openOverlay($('.fpLk:first',$adDisplay),$('.fpOverBlk',$adDisplay));openOverlay($('.jsFpClickLk:first',$adDisplay),$('.jsfpOverlayContent',$adDisplay))}isMiss=false}if(res.missedAdsInfo){missedAdsInfos.push(res.missedAdsInfo)}}}).always(function(){$.mabayaContext.reportAsyncWidget(widgetName,missedAdsInfos,isMiss)})}};loadAdDisplay();$.addToBasketValidate.push(function(mainForm){var $selAdr=$("select.jsOneCkAddr",mainForm),isValide=true;if($selAdr.length>0&&$selAdr.val()==-1){$selAdr.addClass("selMsgVar");isValide=false}return isValide});function initShipping(){var $cShipping=$("#cShipping"),urlShipping=$cShipping.data("action");if(urlShipping){$.ajax({type:"GET",url:urlShipping,success:function(res){if(res.deliveryDelay){res.deliveryDelay.trim().length>0&&$("#deliveryDay").html(res.deliveryDelay)}if(res.customerShipping){var $res=$(res.customerShipping);if($res.is(".jsOverlay")){openOverlay($('.fpLk:first',$res),$('.fpOverBlk',$res));openOverlay($('.jsFpClickLk:first',$res),$('.jsfpOverlayContent',$res))}$(".jsCountdown",$res).countDown({callbackEnd:function(){var $t=$(this);if($t.is(".jsEndStress")){var $parent=$t.parent();$parent.next().show();$parent.remove();$('.jsStressDeliveryFpRedesign').remove()}}});initCDAVButton($res);$cShipping.html($res)}},complete:function(){$cShipping.show();$("#deliveryDay").parent().removeClass("ddn")}})}else{initCDAVButton()}}initShipping();function initCustomShipping(){var $cShipping=$("#cShippingNew"),urlShipping=$cShipping.data("action"),$guaranteedDelivery=$("#guaranteedDelivery",$cShipping),$deliveryDelay=$("#deliveryDelay",$cShipping),$deliveryStress=$("#deliveryStress",$cShipping);if(urlShipping){$.ajax({type:"GET",url:urlShipping,success:function(res){if(res.guaranteedDelivery){$guaranteedDelivery.html(res.guaranteedDelivery)}if(res.deliveryDelay){$deliveryDelay.html(res.deliveryDelay)}if(res.deliveryStress){var $deliveryStressTmp=$(res.deliveryStress);if($deliveryStressTmp.is(".jsOverlay")){openOverlay($('.fpLk:first',$deliveryStressTmp),$('.fpOverBlk',$deliveryStressTmp));openOverlay($('.jsFpClickLk:first',$deliveryStressTmp),$('.jsfpOverlayContent',$deliveryStressTmp))}$(".jsCountdown",$deliveryStressTmp).countDown({callbackEnd:function(){var $t=$(this);if($t.is(".jsEndStress")){var $parent=$t.parent();$parent.next().show();$parent.remove()}}});$deliveryStress.html($deliveryStressTmp);initCDAVButton($deliveryStress)}if(res.deliveryShippingInfo){$("#fpLightShippingList").prepend(res.deliveryShippingInfo);$(".jsFpLightShipping",_$fpColFloat).removeClass("fpLightShippingNo4x")}},complete:function(){$cShipping.show();$deliveryDelay.parent().removeClass("ddn")}})}else{initCDAVButton()}var $fpShippingList=$("#fpShippingList"),urlShipping=$fpShippingList.data("action"),$deliveryStress=$("#deliveryStress");if(urlShipping){$.ajax({type:"GET",url:urlShipping,success:function(res){if(res.deliveryStress){var $deliveryStressTmp=$(res.deliveryStress);if($deliveryStressTmp.is(".jsOverlay")){openOverlay($('.fpLk:first',$deliveryStressTmp),$('.fpOverBlk',$deliveryStressTmp));openOverlay($('.jsFpClickLk:first',$deliveryStressTmp),$('.jsfpOverlayContent',$deliveryStressTmp))}$(".jsCountdown",$deliveryStressTmp).countDown({callbackEnd:function(){var $t=$(this);if($t.is(".jsEndStress")){var $parent=$t.parent();$parent.next().show();$parent.remove();$deliveryStress.remove()}}});$deliveryStress.html($deliveryStressTmp);initCDAVButton($deliveryStress)}if(res.deliveryShippingInfo){$fpShippingList.prepend(res.deliveryShippingInfo);$(".jsOverlay",$fpShippingList).each(function(){bindOverlays(this)})}}})}var $fpPreorder=$(".jsFpPreorder","#fpPreorder"),urlPreorder=$fpPreorder.data("action"),$preorderDeliveryDay=$("#preorderDeliveryDay",$fpPreorder);if(urlPreorder){$.ajax({type:"GET",url:urlPreorder,success:function(res){if(res.deliveryDelay){$preorderDeliveryDay.html(res.deliveryDelay)}}})}}initCustomShipping();$.init("oneCkRedirect",function(opt){var $oneCkForm=$('#oneCkForm')[0];$oneCkForm.action=opt.action;$oneCkForm["basketId"].value=opt.shoppingCartId;$oneCkForm["urlArticle"].value=opt.urlArticle;$oneCkForm.submit()});window.validateSelection=function($blockError){var $errorToShow=$blockError?$blockError:$(".jsMainForm",_$fpTop),productInfo={isValide:$errorToShow.checkFormErrors($(".jsSltSize, .jsSltColor, .jsSltCond",_$fpTop)),pSize:"",pColor:"",pCond:""};if(productInfo.isValide){productInfo.pSize=_$selectSize.val();productInfo.pColor=_$selectColor.val()||_$selectColor.data("value");productInfo.pCond=_$selectCond.val();productInfo.price=$(".fpPrice",_$fpBlocPrice);productInfo.ulrMkp=$("option:selected",_$selectSize).attr('data-productamp')||false;if(productInfo.pSize){productInfo.sku=productInfo.pSize}else if(productInfo.pColor){productInfo.sku=productInfo.pColor}else if(productInfo.pCond){productInfo.sku=productInfo.pCond}}return productInfo};function initOffersBlocksOverlays(offersBlock){var $offersList=$(".jsOffersList li",offersBlock).not(".jsShopOpenHours li"),$overlays=$(".jsOffersList li .jsOlOverlay",offersBlock),$ttoverlays=$(".jsTtOverBlk",offersBlock),$chevrons=$(".jsToolTip",offersBlock),$target=null,evStr="click mouseover",totalHeight=0,hTimer=null,stopTimer=function(fct,tps){hTimer&&win.clearInterval(hTimer);hTimer=typeof fct=="function"?win.setTimeout(fct,tps):null};$chevrons.on(evStr,function(ev){$target=$(this).first().siblings(".jsTtOverBlk");if(!$target.is(":visible")){if(ev.type=="click"){$("#transparentOverlay").show()}$ttoverlays.hide();$target.fadeIn(200)}return false});$offersList.on(evStr,function(ev){$target=$(".jsOlOverlay",$(this));stopTimer(function(){if(!$target.is(":visible")&&ev.target.className.indexOf("jsTTClose")==-1){if(ev.type=="click"){$("#transparentOverlay").show()}$overlays.hide();$target.fadeIn(200)}return false},200)});var closeOverlays=function(){stopTimer(function(){$overlays.fadeOut(200,function(){closeTransparentOverlay()})},200);return false};var closeChevrons=function(){$ttoverlays.fadeOut(200,function(){closeTransparentOverlay()});return false};var closeWithTransparentOverlay=function(){closeOverlays();closeChevrons()};var closeTransparentOverlay=function(){if(!$ttoverlays.is(':visible')&&!$overlays.is(':visible')){$("#transparentOverlay").hide()}};if($.isTouch()){$(".fpCloseOver",offersBlock).bind("click",closeOverlays);$(".jsTTClose",offersBlock).bind("click",closeChevrons);$("body").on("click","#transparentOverlay",closeWithTransparentOverlay);$(".fpCloseOver",offersBlock).removeClass("dn");$(".jsTTClose",offersBlock).show()}$offersList.on("mouseleave",closeOverlays);$chevrons.on("mouseleave",closeChevrons)};$.init("offerOverlays",function(opt){var $offerListBlock=$("#offersListBlock");initOffersBlocksOverlays($offerListBlock)});$.init("offerOverlaysExpress",function(opt){var $offerListBlock=$("#offersListBlockExpress");initOffersBlocksOverlays($offerListBlock)});$.init("offerOverlaysRim",function(opt){var $offerListBlock=$("#nearestRimOfferBlock");initOffersBlocksOverlays($offerListBlock)});var $callCenter=$('.callCenter .innerCallCenter',_$fp);$callCenter.on("click",function(ev){var url=$(this).parent().data('url'),target='_blank';if(!$(ev.target).closest('a').length){window.open(url,target)}});if($.custo){$.custo.addListenerName(function(){initCDAVBloc();if(_$fpBlocPrice&&_$fpBlocPrice.length){initDedicatedDealBloc(_$fpBlocPrice)}if(_$qaBlocProduct&&_$qaBlocProduct.length){initDedicatedDealBloc(_$qaBlocProduct)}})}if(_isSubscriptionAvailable){initSubscriptionBloc();initSessionId()}if(_isRentalAvailable){initRentalBloc()}$(window).load(function(){_$fp.initMabayaCarrousel()});$(".jsToolTip",_$fp).toolTip();var IsExpressHighlightCdiscountContext=function(offerSellerId,offerIsHighlight){var isExpressHighlightContext=false;if($.cookies.get("ExpressGlobalSellerId","__")==offerSellerId&&offerIsHighlight==1){isExpressHighlightContext=true;var hashes=window.location.href.slice(window.location.href.indexOf('?')+1).split('#');for(var i=0;i<hashes.length;i++){if(hashes[i].toLowerCase()=="expressorigin"){isExpressHighlightContext=false;break}}}return isExpressHighlightContext};var maskUnmaskExpressShippingVD=function(expShpVd,noDisplay){if(undefined!==expShpVd&&expShpVd.length){expShpVd.removeClass();if(noDisplay){expShpVd.addClass("dn")}}};var manageDisplayOfWishAndShoppingList=function(wishListBlock,shoppingListBlock,classForWishList,classForShoppingList){if(undefined!==shoppingListBlock&&shoppingListBlock.length){shoppingListBlock.removeClass().addClass(classForShoppingList)}if(undefined!==wishListBlock&&wishListBlock.length){wishListBlock.removeClass().addClass(classForWishList)}};var subBtAddValue=function(btAddId,btHiddenIdContainsNewVal){if($(btHiddenIdContainsNewVal).length&&$(btAddId).length){$(btAddId).val($(btHiddenIdContainsNewVal).val())}};(function(){var isExpressHighlightContext=$("#shippingBlocOfferSellerId").length&&$("#shippingBlocOfferIsExpressHighlight").length&&IsExpressHighlightCdiscountContext($("#shippingBlocOfferSellerId").val(),$("#shippingBlocOfferIsExpressHighlight").val());maskUnmaskExpressShippingVD($("#expressShippingPrice"),isExpressHighlightContext);maskUnmaskExpressShippingVD($("#expressShippingDelay"),isExpressHighlightContext);maskUnmaskExpressShippingVD($("#expressShippingHighlight"),!isExpressHighlightContext)})();(function(){if($("#ProductFormData_ProductPostedForm_RedirectToBackOnAddToBasket").length&&$("#ProductFormData_ProductPostedForm_IsExpressHighlightOffer").length){var isExpressHighlightContext=$("#ProductFormData_ProductPostedForm_SellerId").length&&IsExpressHighlightCdiscountContext($("#ProductFormData_ProductPostedForm_SellerId").val(),$("#ProductFormData_ProductPostedForm_IsExpressHighlightOffer").val());$("#ProductFormData_ProductPostedForm_RedirectToBackOnAddToBasket").val(isExpressHighlightContext?"True":"False")}})();(function(){var offerListBlock=$("#offersListBlock");if(offerListBlock.length){if($("#additionalOfferBlockOfferExpress").length&&$("#additionalOfferBlockOfferExpress").val()==1){var isExpressHighlightContext=$("#additionalOfferBlockOfferSellerId").length&&$("#additionalOfferBlockOfferExpressHighlight").length&&IsExpressHighlightCdiscountContext($("#additionalOfferBlockOfferSellerId").val(),$("#additionalOfferBlockOfferExpressHighlight").val());if(!isExpressHighlightContext){offerListBlock.removeClass().addClass("dn")}}}})();(function(){if($("#shoppingListBlockOfferExpress").length&&$("#shoppingListBlockOfferExpress").val()==1){var isExpressHighlightContext=$("#shoppingListBlockOfferSellerId").length&&$("#shoppingListBlockOfferExpressHighlight").length&&IsExpressHighlightCdiscountContext($("#shoppingListBlockOfferSellerId").val(),$("#shoppingListBlockOfferExpressHighlight").val());if(isExpressHighlightContext){manageDisplayOfWishAndShoppingList($("#fpWlBloc"),$("#shoppingListBlock"),"","dn")}else{manageDisplayOfWishAndShoppingList($("#fpWlBloc"),$("#shoppingListBlock"),"dn","cdsExpressWLBloc")}}else{manageDisplayOfWishAndShoppingList($("#fpWlBloc"),$("#shoppingListBlock"),"","dn")}})();(function(){if($("#ProductFormData_ProductPostedForm_IsExpressOffer").length&&$("#ProductFormData_ProductPostedForm_IsExpressOffer").val()==1){var isExpressHighlightContext=$("#ProductFormData_ProductPostedForm_SellerId").length&&$("#ProductFormData_ProductPostedForm_IsExpressHighlightOffer").length&&IsExpressHighlightCdiscountContext($("#ProductFormData_ProductPostedForm_SellerId").val(),$("#ProductFormData_ProductPostedForm_IsExpressHighlightOffer").val());subBtAddValue("#fpAddBsk",isExpressHighlightContext?"#btAddMsgAddToBasket":"#btAddMsgAdd")}else{subBtAddValue("#fpAddBsk","#btAddMsgAddToBasket")}})();var cAjaxRentOfferZoneCtrl=$("#cAjaxRentOfferZone");if(cAjaxRentOfferZoneCtrl){var ajaxUrlLLD=cAjaxRentOfferZoneCtrl.data("action");if(ajaxUrlLLD)$.ajax({url:ajaxUrlLLD,type:'GET',dataType:"json",success:function(res){if(res){$("#cAjaxRentOfferZone").html(res.Data);initSessionId()}}})}var rentOfferZone=$("#fpOfferRentBlock");if(rentOfferZone){initSessionId()}var rentOfferZone=$("#fpOfferRentBlock");if(rentOfferZone){initSessionId()}var rentOfferZone=$("#fpOfferRentBlock");if(rentOfferZone){initSessionId()}});$.init("fpBSellers",function(opt){var CDSUrl="cdiscount.com";(function(refer){if(refer==""||(refer&&refer.indexOf(CDSUrl)==-1)){document.getElementById("BSZone").className="fpBSZone"}})(document.referrer)});window.onpageshow=function(event){if(event.persisted){window.location.reload()}}})(window,window.jQuery||window.cm);
/* Js/cdsrwd/wl/rwd/page/innersense.js */
(function(win,$){$.init("innersense",function(opt){var $mainZone=$("#fpZnPrdMain");var blob=null;$mainZone.on("click",".jsBtShowInnersense",function(){var $iframe=$("#innersenseViewer");var iframeWindow=$iframe[0].contentWindow?$iframe[0].contentWindow:$iframe[0].contentDocument.defaultView;var $pictureZone=$(".jsPictureZone",$mainZone);$pictureZone.hide();$iframe.addClass("show");if(!blob){$.get($iframe.data("css"),function(data){blob=new Blob([data],{type:"text/css"});iframeWindow.postMessage({type:'init',hiddenMenu:false,showTuto:false,blobCSSDefault:blob},"*")})}});$mainZone.on("click",".jsFpZoomPic",function(){var $iframe=$("#innersenseViewer");var $pictureZone=$(".jsPictureZone",$mainZone);$iframe.removeClass("show");$pictureZone.show()})})})(window,window.jQuery||window.cm);
/* Js/cdsrwd/wl/rwd/page/shoppingList.js */
(function(win,$){$.init("ShoppingList",function(options){var settings=$.extend({urlShoppingListJson:'',shoppingListPopinUrl:'',connectionPopUpUrl:'',shoppingListDisplayedId:'',productIdToDisplayAtLoad:'',addShoppingListToBasketUrl:'',oid:'',addShoppingListDivId:'main'},options),$menuV=$('#menuV'),$jsShoppingList=$('.jsShoppingList',$menuV),updateSLLeftMenu=function(){if($jsShoppingList.length&&settings.urlShoppingListJson){$.ajax({type:"GET",url:settings.urlShoppingListJson,dataType:"json",cache:false,success:function(res){res.connected=$.nav.session.isAuthenticate();$jsShoppingList.html($(Mustache.render($('#lpSListTemplate').html(),res)));if(settings.shoppingListDisplayedId){$("select",$jsShoppingList).val(settings.shoppingListDisplayedId)}$jsShoppingList.show()}})}};$jsShoppingList.on('change','select',function(){var listTypeId=$(this).find(':selected').data("listtypeid"),listTypeQueryString="";if(listTypeId)listTypeQueryString='&listTypeId='+listTypeId;if(this.value){document.location.href='?listId='+this.value+listTypeQueryString}});var callbackPopin=function(){var $popin=$('.popinAlimExpress',document.body);$popin.removeClass("popinFpPrdt");$popin.on('click','.jsAction:not(.jsDisabled)',function(){var $form=$(this.form),option={addedClass:'popinAlimExpress',method:$form.prop('method'),data:$form.serialize(),callback:updateSLLeftMenu};$.popin.hideOverlay();$.popin.loadAjaxPopin($form.prop('action'),option);return false});$popin.on('click','.jsPopin',function(){$.popin.hideOverlay();var option={addedClass:'popinAlimExpress'};$.popin.loadAjaxPopin($(this).data('url'),option);return false});$popin.on('click','.jsCheckbox',function(){var $btnForm=$('.jsAction',this.form);if($('input[type=checkbox]:checked',this.form).length>0){$btnForm.removeClass('jsDisabled disabled');$btnForm.removeAttr('disabled')}else{$btnForm.addClass('jsDisabled disabled');$btnForm.attr('disabled','disabled')}});$popin.on('keypress','.sListName',function(event){var regex=/^([\w\-àçèéêëîïôöùûü] {0,1})$/,_event=event||window.event,key=_event.keyCode||_event.which,key=String.fromCharCode(key);if(!regex.test(key)){_event.returnValue=false;if(_event.preventDefault)_event.preventDefault()}});$popin.on('keyup','.sListName',function(event){$btnForm=$('.jsAction',this.form);if(this.value){$btnForm.removeClass('jsDisabled disabled');$btnForm.removeAttr('disabled')}else{$btnForm.addClass('jsDisabled disabled');$btnForm.attr('disabled','disabled')}});updateSLLeftMenu();return false};$('#'+settings.addShoppingListDivId).on('click','.jsAddToList',function(){var productId=$(this).data('productid'),productOfferId=$(this).data('offerid');if($.nav.session.isAuthenticate()){var option={addedClass:'popinAlimExpress',callback:callbackPopin};$.popin.loadAjaxPopin(settings.shoppingListPopinUrl+'/'+productId,option)}else{if(settings.connectionPopUpUrl!==''){var parameters='/'+productId;if(productOfferId!==undefined){parameters+='/'+productOfferId}return $.windowPopupExpress(settings.connectionPopUpUrl+parameters+'.html','LoginPopup',830,600)}}return false});if(settings.addShoppingListToBasketUrl){$('#AddShoppingListToBasket').click(function(){var option={addedClass:'popinAlimExpress',callback:function(){updateExpressBasket($('.jsUpdateUrl',$('.popinAlimExpress')).data("updateurl"))}};$.popin.loadAjaxPopin(settings.addShoppingListToBasketUrl,option);return false});if(settings.oid){option={addedClass:'popinAlimExpress cz',method:'POST',data:{orderId:settings.oid},callback:function(){updateExpressBasket($('.jsUpdateUrl',$('.popinAlimExpress')).data("updateurl"))}};$.popin.loadAjaxPopin(settings.addShoppingListToBasketUrl,option)}}updateSLLeftMenu();if(settings.productIdToDisplayAtLoad){var option={addedClass:'popinAlimExpress',callback:callbackPopin};$.popin.loadAjaxPopin(settings.shoppingListPopinUrl+'/'+settings.productIdToDisplayAtLoad,option)}})})(window,window.$fwk);
/* Js/cdsrwd/wl/rwd/block/nego.js */
$.init("nego",function(opt){var moneyUnit=opt.devise;var productId="";var $negociateButtonBlock=$("#fpBlocPrice .jsNegociate, #qaBlocPrice .jsNegociate, #basketNegoIdent .jsBasketNegoForm");var $btnNegociateBlock=$(".jsBtnNegociate",$negociateButtonBlock);var delay=$btnNegociateBlock.data("display-delay");var popinInDelay=true;if(!delay||isNaN(delay)){delay=2000}setTimeout(function(){$negociateButtonBlock.slideDown("slow")},delay);var delayShowPopin=$btnNegociateBlock.data("display-popin-delay");var negotiationType=$btnNegociateBlock.data("nego-basket");function checkNegoErrors(){var _$fpTop=$("#fpContent .jsTop"),$itemsToCheck=$(".jsSltSize, .jsSltColor, .jsSltCond",_$fpTop),$msgBox=$(".jsValMsg",$negociateButtonBlock);if(!$itemsToCheck){return true}var $selectErr=$itemsToCheck.filter(function(){var isSelected;if(this.value){isSelected=this.value!=-1}else{isSelected=$(this).data("value")}return!isSelected}).addClass("selMsgVar");if($selectErr.length>0){toggleErrors(true);var msg=errorMsg.begin,moreThanOne=0;for(var x=0;x<listErrorMsg.length;x++){if($selectErr.filter(listErrorMsg[x].selector).length){if(moreThanOne>0){if(moreThanOne==($selectErr.length-1))msg+=errorMsg.lastSeparator+listErrorMsg[x].message;else msg+=errorMsg.separator+listErrorMsg[x].message}else msg+=listErrorMsg[x].message;moreThanOne++}}$msgBox.html(msg)}else{toggleErrors(false)}return!$selectErr.length};function toggleErrors(visible){if(visible==true){$(".jsValMsg",$negociateButtonBlock).fadeTo("fast",1);$(".jsValidButton",$negociateButtonBlock).addClass("clickDisabled")}else if(visible==false){$(".jsValMsg",$negociateButtonBlock).fadeTo("fast",0);$(".jsValidButton",$negociateButtonBlock).removeClass("clickDisabled")}}$negociateButtonBlock.on("mouseover",".jsValidButton",function(){checkNegoErrors()});$negociateButtonBlock.on("mouseout",".jsValidButton",function(){toggleErrors(false)});var $mainForm=$(".jsMainForm");$btnNegociateBlock.on("click",function(){popinInDelay=false;var isValid=checkNegoErrors();if(isValid){showNegociationPopin()}});function showNegociationPopin(){if(negotiationType!=null&&$.cookies.get("articles_count")==0){return false}var urlPopin=$btnNegociateBlock.data('url');var option=null;if(negotiationType!=null){var $basketNegoContext=$("#basketNegoIdent");option={addedClass:'ppCnego jsPpCnego ppCnegoB',callback:callbackCNegoPopin,data:$(".jsBasketNegoForm",$basketNegoContext).serialize()}}else{option={addedClass:'ppCnego jsPpCnego ppCnegoB',callback:callbackCNegoPopin,data:$mainForm.find(":input").not("[value*='.html']").serialize()}}loadNegociationPopin(urlPopin,option);return false}function loadNegociationPopin(urlPopin,option){if(!option.isMakeNegotiation){$.popin.showWaitingOverlay();document.body.style.overflow="hidden"}var $popinNegotiation=$("#popinContainer");var $popinNegotiationResult=$("#popinResultContainer");popin=document.createElement("div");$popin=$(popin);$popin.empty();$popin.hide();popin.className="popin";document.body.appendChild(popin);var type=option.type!=null?option.type:'GET';$.ajax({type:type,url:urlPopin,dataType:"html",data:option.data,cache:false,success:function(data){$popin=$(popin);if(option.isMakeNegotiation){$popin.attr('id','popinResultContainer')}else{$popin.attr('id','popinContainer')}var btnClose=document.createElement("div");btnClose.className="pClose";btnClose.innerHTML="&#10006";btnClose.className+=" jsCancel";popin.appendChild(btnClose);if(option.addedClass){$popin.addClass(option.addedClass)}$.popin.showOverlay({isOverlayClick:true,callback:function(){$popin.remove();document.body.style.overflow="auto"}});var dataHTML=document.createElement('div');dataHTML.innerHTML=data;popin.appendChild(dataHTML);$(".jsCancel",$popin).click(function(){$.popin.hideOverlay();$popin.remove();document.body.style.overflow="auto";return false});if($popinNegotiation.length){$popinNegotiation.remove()}if($popinNegotiationResult.length){$popinNegotiationResult.remove()}if(dataHTML.getElementsByTagName('script').length>0){eval(dataHTML.getElementsByTagName('script')[0].innerHTML)}option.callback();$popin.show()},complete:function(){$("#waitingOverlay").hide();if(!option.isMakeNegotiation){$(".jsCnegoProp input",$popin).focus()}}})}function preCheckProposal(proposal,$negoInfoBlock){proposal=proposal.replace(/,/g,'.');var proposalNaN=isNaN(proposal);$negoInfoBlock.removeClass("ppCnegoInit ppCnego00 ppCnego01 ppCnego30 ppCnego30 ppCnego50 ppCnego70 ppCnego101 ppCnegoInvalid");if(proposalNaN){$negoInfoBlock.addClass("ppCnegoInvalid")}else{var min=$negoInfoBlock.data("min");var max=$negoInfoBlock.data("top");var percent=(proposal-min)/(max-min)*100;var economy=Math.round((max-proposal)*100)/100;var economyPercent=(max-proposal)/max*100;var tooHighProposal=max-proposal<=0;if(percent<0||tooHighProposal){percent=0}else{percent=Math.round(percent)}if(tooHighProposal){$negoInfoBlock.addClass("ppCnego101")}else{if(percent==0){$negoInfoBlock.addClass("ppCnego00")}else if(percent<30){$negoInfoBlock.addClass("ppCnego01")}else if(percent<50){$negoInfoBlock.addClass("ppCnego30")}else if(percent<70){$negoInfoBlock.addClass("ppCnego50")}else{$negoInfoBlock.addClass("ppCnego70")}}var $gauge=$(".jsCnegoPercentGauge",$negoInfoBlock),$percentBlock=$(".jsCnegoPercent span",$negoInfoBlock);$percentBlock.html(percent+"%");if(percent==0){$gauge.height(100)}else{$gauge.height("calc("+(100-percent)+"% + 0.42px)")}var $ecoBlock=$(".jsCnegoEco .jsPercentEcoText",$negoInfoBlock);if(!tooHighProposal){if(economy>economyPercent){var economySplit=economy.toFixed(2).toString().split(".");var price=economySplit[0];var cent=moneyUnit;if(economySplit.length>1){cent=moneyUnit+economySplit[1]}$ecoBlock.html(price+"<sup>"+cent+"</sup>")}else{$ecoBlock.html(economyPercent.toFixed(2)+"%")}}}}function callbackCNegoPopin(){var $negoInfo=$("#ppCnego");var timeout;var $buttonNegociate=$(".jsCnegoBtCTA",$negoInfo);var $negoForm=$(".jsCnegoForm",$negoInfo);$buttonNegociate.click(function(){var urlPopin=this.form.action;var $askedPrice=$('.jsCnegoProp input',$negoInfo);$askedPrice.val($askedPrice.val().replace(',','.'));var option={addedClass:'ppCnego jsPpCnego ppCnegoW',data:$negoForm.serialize(),callback:callbackCNegoPopin,isMakeNegotiation:true};$.popin.showWaitingOverlay();document.body.style.overflow="hidden";setTimeout(function(){loadNegociationPopin(urlPopin,option)},4000);return false});var $negoContainer=$("#popinContainer");var $negoLogin=$("#NegoLogin");var $loginCustomerBlock=$("#loginCustomerBlock");var $cdavNegoForm=$("form",$negoLogin);var $btnCustomerLogin=$(".customerLogin",$loginCustomerBlock);var $btnValidateLogin=$(".validateLogin",$negoLogin);var $btnCdavAdd=$(".addCdav",$negoContainer);$btnCustomerLogin.click(function(){var option={addedClass:'ppCnego jsPpCnego ppCnegoB',callback:callbackCNegoPopin};var urlPopin=$btnCustomerLogin.data('url');loadNegociationPopin(urlPopin,option)});$btnValidateLogin.click(function(){var option={addedClass:'ppCnego jsPpCnego ppCnegoB',callback:callbackCNegoPopin,data:$cdavNegoForm.serialize(),type:'Post'};var urlPopin=this.form.action;loadNegociationPopin(urlPopin,option);return false});$btnCdavAdd.click(function(){var option={addedClass:'ppCnego jsPpCnego ppCnegoB',callback:callbackCNegoPopin};var urlPopin=$btnCdavAdd.data('url');loadNegociationPopin(urlPopin,option)});$negoInfo.on("keypress",".jsCnegoProp input",function(e){var regex=/^[0-9]{1,4}([.|,][0-9]{0,2})?$/;var charCode=e.which?e.which:(e.charCode?e.charCode:(e.keyCode?e.keyCode:0));var keyPressed=String.fromCharCode(charCode);var negoValue=$(this).val();if(this.selectionStart==0&&this.selectionEnd==this.value.length){negoValue=''}var negoValueArray=negoValue.split('');if(this.selectionStart!=this.selectionEnd||(this.selectionStart==this.selectionEnd&&negoValue.length!=this.selectionEnd)){negoValueArray.splice(this.selectionStart,this.selectionEnd-this.selectionStart,keyPressed);negoValue=negoValueArray.join('');keyPressed=''}if((charCode==8&&!regex.test(negoValue))||(charCode!=8&&!regex.test(negoValue+keyPressed))){e.preventDefault()}});$negoInfo.on("keyup",".jsCnegoProp input",function(event){if(timeout){clearTimeout(timeout);timeout=null}var proposal=this.value;timeout=setTimeout(function(){if(proposal!=""){preCheckProposal(proposal,$negoInfo)}else{$negoInfo.removeClass("ppCnegoInit ppCnego00 ppCnego01 ppCnego30 ppCnego30 ppCnego50 ppCnego70 ppCnego101 ppCnegoInvalid");$negoInfo.addClass("ppCnegoInit")}},400)});var $negoCdavResultBlock=$("#negoCdavResult");$(".jsCboxAddCdav",$negoCdavResultBlock).change(function(){if(this.checked){$('.jsNegotiationCustomerInfo',$negoCdavResultBlock).hide();$('.ppCnegoAddToBasketWithCdav',$negoCdavResultBlock).show()}else{$('.ppCnegoAddToBasketWithCdav',$negoCdavResultBlock).hide();$('.jsNegotiationCustomerInfo',$negoCdavResultBlock).show()}})}if(delayShowPopin&&delayShowPopin.length!=0){setTimeout(function(){if(popinInDelay){showNegociationPopin()}},delayShowPopin)}});
/* Js/cdsrwd/wl/rwd/block/reportReview.js */
$.init("reportReview",function(opt){var $ratingReviewBlock=$(".jsDetRating"),$btnReportBlock=$(".jsReportReview",$ratingReviewBlock),$link=null;$btnReportBlock.on("click",function(){var reviewId=$(this).data("review"),urlPopin=$(this).data("url");if(!reviewId||!urlPopin){return false}$link=$(this);var option={addedClass:'popin reportReviewPopin ',callback:callbackReportReview,data:{ReviewId:reviewId}};$.popin.showOverlay();$.popin.loadAjaxPopin(urlPopin,option);return false});function callbackReportReview(){var $reporReviewPopin=$(".jsReportReviewPopinContent"),$reportForm=$("#reportReviewPopinForm",$reporReviewPopin),$txtReport=$(".jsReportReviewText",$reportForm),$buttonReport=$(".jsReportReviewBt",$reportForm),$reportReviewCount=$(".jsReportReviewCharCount",$reportForm),$spanCharCount=$("span",$reportForm),$isCaptchaValidated=$("input[name=IsCaptchaValidated]",$reportForm),reportReviewCaptcha=null;$txtReport.on("keyup",function(event){var text=$txtReport.val();var charsCount=text.length;if(charsCount>=15){$reportReviewCount.addClass("hidden");$buttonReport.removeClass("clickDisabled")}else{$spanCharCount.text(15-charsCount);$reportReviewCount.removeClass("hidden");$buttonReport.addClass("clickDisabled")}});$(".jsReportReviewBt",$reportForm).on("mousemove",function(event){var $t=$(this),reportContent=$txtReport.val(),reportContentLen=reportContent.length;if(!reportContent||reportContentLen<15){$t.addClass("clickDisabled");$(".jsErrorMsg",$reportForm).show()}});$(".jsReportReviewBt",$reportForm).on("mouseout",function(event){$(this).removeClass("clickDisabled");$(".jsErrorMsg",$reportForm).hide()});$buttonReport.on("click",function(event){event.preventDefault();var reportContent=$txtReport.val(),reportContentLen=reportContent.length,$captcha=$(".g-recaptcha",$reportForm);refreshCaptcha=function(){if(reportReviewCaptcha==null){reportReviewCaptcha=grecaptcha.render($captcha[0],{sitekey:$captcha.data("sitekey"),"expired-callback":"reportCaptchaExpired"})}else{grecaptcha.reset(reportReviewCaptcha)}};reportCaptchaValidated=function(){setCaptchaValidated(true)};reportCaptchaExpired=function(){setCaptchaValidated(false)};setCaptchaValidated=function(value){if($isCaptchaValidated&&$isCaptchaValidated.length){$isCaptchaValidated.val(value)}};if($isCaptchaValidated.val()!=="true"){refreshCaptcha();return false}if(!reportContent||reportContentLen<15){$buttonReport.addClass("clickDisabled");$(".jsErrorMsg",$reportForm).show();return false}toggleReport=function(){var $t=$link,$p=$t.parent(),$detRatingP=$t.parents(".jsDetRating"),$star=$detRatingP.find(".jsSta");$t.remove();$(".jsReported",$p).fadeToggle("fast");$detRatingP.addClass("deactivatedDetRating");$star.addClass("deactivatedRatingStar")};$.ajax({type:"POST",url:this.form.action,dataType:"html",data:$reportForm.serialize(),cache:false,complete:function(){closePopin();toggleReport()}});closePopin=function(){$(".jsCancel",$reporReviewPopin).trigger("click");return false};return false})}});
/* Js/Tracking/cds.fwk.tracking.js */
(function($){$.track=$.track||{};$.track.providers=$.track.providers||[];$.track.send=$.track.send||function(){for(var idx in $.track.providers){if($.track.providers.hasOwnProperty(idx)){var providerName=$.track.providers[idx];$.track[providerName].send()}}}})(jQuery);
/* Js/Tracking/cds.tracking.js */
(function($){var tracking={};tracking.params=($.track&&$.track.tracking)?$.track.tracking.params||{}:{};tracking.url='http://localhost:57918/realtimetracking/track';tracking.init=(function(tracking){return(function(){var e=document.documentElement,g=document.getElementsByTagName('body')[0],width=window.innerWidth||e.clientWidth||g.clientWidth,height=window.innerHeight||e.clientHeight||g.clientHeight;tracking.params['rH']=height;tracking.params['rW']=width;if(tracking.params['type']=="ADD_TO_BASKET"&&tracking.params['url']){tracking.params['url']=window.location.href+tracking.params['url']}else{tracking.params['url']=window.location.href}tracking.params['fvid']=$.cookies.get("UniqueVisitContext");if(tracking.params['type']!="SEARCH"&&!tracking.params['ref']){tracking.params['ref']=document.referrer}var hash=window.location.hash;if(hash&&hash.indexOf('atcpl')!=-1){tracking.params['type']='PRODUCT_MERCHANDISING'}var idx=document.cookie.indexOf("_$1okcook");tracking.params['prop24']=(idx!=-1)?document.cookie.substr(idx+10,1):0})})(tracking);tracking.send=(function(tracking){return(function(skipInit){if(!skipInit){tracking.init()}var params=JSON.stringify(tracking.params);$.ajax({url:tracking.url,type:'POST',data:params,contentType:'application/json; charset=utf-8',dataType:'json'})})})(tracking);$.track.providers.push('tracking');$.track.tracking=tracking;$.init("RealTimeTracking")})(jQuery);
